<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
    <title>Gone Viral!</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

        :root {
            --board-size: 720px
        }

        html, body {
            height: 100%;
            margin: 0;
            font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial;
            /* full-page background image, fixed centered - made to work in both narrow and wide configurations */
            background: linear-gradient(rgba(0,0,0,0.45), rgba(0,0,0,0.45)), url('https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/lab.png') center center / cover no-repeat fixed;
            color: #0b3d91;
        }

        /* Make wrap and board semi-transparent so background shows through
        Layout behavior:
        - Default (mobile / narrow): vertical stack — board above, hud spans full width at bottom.
        - Wide screens (min-width:900px): horizontal layout — board on left, hud fixed-width column on right. */
        .wrap {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(255,255,255,0.18);
            border-radius: 12px;
            position: relative;
            z-index: 2;
            width: 100%;
            box-sizing: border-box;
            max-width: 1200px;
            margin: 0 auto;
        }

        .board {
            width: min(var(--board-size),94vw);
            aspect-ratio: 1;
            background: rgba(255,255,255,0.22);
            border-radius: 12px;
            padding: 0;
            display: grid;
            grid-template-columns: repeat(6,1fr);
            grid-auto-rows: 1fr;
            gap: 0;
            box-sizing: border-box
        }

        /* HUD styling — responsive: full-width on narrow, right-column on wide, test on mobile and browser */
        .hud {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
            background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.04));
            border-radius: 12px;
            padding: 8px;
            width: 100%;
            box-sizing: border-box;
            border: 4px solid rgba(0,0,0,0.25);
            box-shadow: 8px 8px 0 rgba(0,0,0,0.12), -6px -6px 0 rgba(255,255,255,0.02);
            font-family: 'Press Start 2P', monospace;
            color: #ffd166;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.55);
        }

        /* Unified Score + High Score box, fully left-justified */
        .small.scorebox {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start; /* stop flex centering */
            text-align: left !important; /* override .small center alignment */
            line-height: 1.2;
            width: 100%; /* ensures text uses full box width */
        }

            .small.scorebox .score-line,
            .small.scorebox .high-line {
                width: 100%;
                text-align: left !important; /* force left alignment inside */
            }

            .small.scorebox .score-line {
                font-size: 9px;
                color: #ffd166;
            }

            .small.scorebox .high-line {
                font-size: 8px;
                opacity: 0.85;
                color: #ffe9b0;
                margin-top: 2px;
                text-shadow: 1px 1px 0 rgba(0,0,0,0.55);
            }

                .small.scorebox .high-line span#highScoreValue {
                    font-size: inherit;
                }

        .level-box {
            font-size: 9px; /* or whatever size you want */
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
            background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.04));
            border-radius: 12px;
            padding: 8px;
            width: 50%;
            box-sizing: border-box;
            border: 4px solid rgba(0,0,0,0.25);
            box-shadow: 8px 8px 0 rgba(0,0,0,0.12), -6px -6px 0 rgba(255,255,255,0.02);
            font-family: 'Press Start 2P', monospace;
            color: #ffd166;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.55);
        }


        /* On wide screens place HUD to the right at a fixed column width */
        @media (min-width: 900px) {
            .wrap {
                flex-direction: row;
                align-items: flex-start;
                justify-content: center;
                gap: 20px;
                padding: 20px
            }

            .board {
                order: 1;
                width: calc(min(var(--board-size),74vw));
                max-width: calc(100% - 300px)
            }

            .hud {
                order: 2;
                width: 300px;
                flex-direction: column;
                align-items: flex-start;
                justify-content: flex-start;
                padding: 18px 14px
            }

                .hud .small {
                    align-self: stretch
                }

                .hud button {
                    width: 100%
                }
        }

        /* cell property style */
        .cell {
            background: transparent;
            border-radius: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            cursor: pointer;
            overflow: visible;
            padding: 0;
            box-sizing: content-box;
            width: 100%;
            height: 100%
        }

        /* virus property sytle */
        .virus {
            width: 100%;
            height: 100%;
            position: relative;
            z-index: 3;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: visible;
            box-sizing: content-box
        }

        /* Petri dish on each cell - property style */
        .petri {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%,-50%) scale(1.2);
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none; /* experimental */
            display: flex;
            align-items: center;
            justify-content: center;
            transform-origin: center center
        }

            .petri img {
                width: 100%;
                height: 100%;
                object-fit: contain;
                display: block;
                opacity: 1
            }

        /* virus face sprite: single centered image, only scaling changes */
        .face-sprite {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: visible;
            z-index: 3;
            pointer-events: none; /* experimental */
            transform-origin: center center;
            display: flex;
            align-items: center;
            justify-content: center
        }

            .face-sprite img {
                width: 100%;
                height: 100%;
                object-fit: contain;
                image-rendering: pixelated;
                pointer-events: none;
                transform-origin: center center;
                display: block
            }

        /* Animate size-3 viruses with gentle jitter/pulse - make it look like it's ready to burst! */
        @keyframes jitter {
            0%,100% {
                transform: scale(1) translate(0, 0);
            }

            25% {
                transform: scale(1.03) translate(1px, -1px);
            }

            50% {
                transform: scale(0.97) translate(-1px, 1px);
            }

            75% {
                transform: scale(1.02) translate(-1px, -1px);
            }
        }

        .virus--size-3 .face-sprite img {
            animation: jitter 0.45s infinite ease-in-out;
        }

        /* Animate the splat/stain/burst when a virus pops */
        .stain {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%,-50%) scale(0);
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle at 28% 28%, rgba(110,200,40,0.44), rgba(30,100,20,0.24));
            pointer-events: none;
            opacity: 0;
            z-index: 4
        }

            .stain.show {
                animation: stainpop 520ms forwards
            }

        @keyframes stainpop {
            0% {
                transform: translate(-50%,-50%) scale(0);
                opacity: 0.95
            }

            50% {
                transform: translate(-50%,-50%) scale(1.08);
                opacity: 0.7
            }

            100% {
                transform: translate(-50%,-50%) scale(1.8);
                opacity: 0
            }
        }

        /* --- SPRITE-BASED PARTICLES + randomized rotation support --- */
        .particle {
            position: fixed;
            z-index: 30000;
            width: 30px; /* small size as default */
            height: 30px;
            pointer-events: none;
            transform-origin: center center;
            transform: translate3d(0px, 0px, 0) translate(-50%, -50%) scale(0.9);
            opacity: 1;
            display: block;
            image-rendering: pixelated;
            filter: drop-shadow(0 4px 10px rgba(120,40,160,0.12));
            will-change: transform, opacity;
            transition: transform 520ms cubic-bezier(.2,.8,.2,1), opacity 180ms linear;
        }

            /* particle contains an <img> (raster sprite) */
            .particle > img {
                width: 100%;
                height: 100%;
                display: block;
                pointer-events: none;
                user-select: none;
                -webkit-user-drag: none;
            }


        /* HUD child elements: retro 'panels' for each stat */
        .hud .small {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            background: linear-gradient(180deg, rgba(0,0,0,0.12), rgba(255,255,255,0.02));
            padding: 10px 12px;
            border-radius: 8px;
            border: 4px solid rgba(0,0,0,0.25);
            box-shadow: 6px 6px 0 rgba(0,0,0,0.12);
            min-width: 85px;
            color: #ffd166;
            font-family: 'Press Start 2P', monospace;
            font-size: 11px;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.55);
        }

        .hud-row {
            display: flex;
            flex-direction: row;
            gap: 12px; /* spacing between Level and Score */
            align-items: center;
        }

        /* Make HUD buttons match retro badge look */
        .hud button {
            font-family: 'Press Start 2P', monospace;
            background: linear-gradient(180deg,#ffffff,#e6e3ff);
            color: #0b3d91;
            border: 4px solid rgba(0,0,0,0.18);
            padding: 10px;
            border-radius: 8px;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.12);
            cursor: pointer;
            font-size: 11px;
        }

        /* small screens tweak */
        @media (max-width:420px) {
            .board {
                width: 94vw
            }

            .hud .small {
                min-width: 90px;
                padding: 8px;
                font-size: 10px
            }
        }

        /* glowing burst at pop */
        .glow {
            position: fixed;
            z-index: 25000;
            pointer-events: none;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            filter: blur(10px);
            opacity: 0.95;
            background: radial-gradient(circle at 35% 30%, rgba(157,0,255,0.95), rgba(130,0,150,0.6) 40%, rgba(255,90,20,0.15) 70%);
        }

        @keyframes glowPop {
            0% {
                transform: translate(-50%,-50%) scale(0.2);
                opacity: 0.95
            }

            30% {
                transform: translate(-50%,-50%) scale(1.2);
                opacity: 0.9
            }

            70% {
                transform: translate(-50%,-50%) scale(1.6);
                opacity: 0.45
            }

            100% {
                transform: translate(-50%,-50%) scale(2.4);
                opacity: 0
            }
        }

        /* Badge UI — retro styling using Press Start 2P */
        .chain-badge {
            position: fixed;
            left: 50%;
            top: 12%;
            transform: translateX(-50%) translateY(-6px) scale(0.85);
            z-index: 40000;
            font-family: 'Press Start 2P', monospace;
            background: linear-gradient(180deg, #0b3d91, #08306a); /* default deep-blue base for retro look */
            color: #ffd166; /* warm pixel color for text */
            padding: 10px 18px;
            border-radius: 8px;
            border: 4px solid rgba(0,0,0,0.45); /* thick pixel-like border */
            font-weight: 400;
            font-size: 14px;
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: center;
            pointer-events: none;
            opacity: 0;
            will-change: transform, opacity;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.65), 4px 4px 0 rgba(0,0,0,0.45); /* chunky pixel shadow */
        }

            .chain-badge .cb-icon {
                width: 44px;
                height: 36px;
                border-radius: 6px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 18px;
                background: rgba(0,0,0,0.18);
                box-shadow: inset -6px -6px 0 rgba(0,0,0,0.12), inset 6px 6px 0 rgba(255,255,255,0.02);
            }

        @keyframes badgeIn {
            0% {
                transform: translateX(-50%) translateY(6px) scale(0.7);
                opacity: 0;
            }

            50% {
                transform: translateX(-50%) translateY(-6px) scale(1.05);
                opacity: 1;
            }

            100% {
                transform: translateX(-50%) translateY(-18px) scale(1);
                opacity: 1;
            }
        }

        @keyframes badgeOut {
            0% {
                opacity: 1;
                transform: translateX(-50%) translateY(-18px) scale(1);
            }

            100% {
                opacity: 0;
                transform: translateX(-50%) translateY(-28px) scale(0.9);
            }
        }

        .chain-badge.show {
            animation: badgeIn 360ms steps(2,end) forwards;
        }

        .chain-badge.hide {
            animation: badgeOut 360ms ease forwards;
        }

        /* Retro color variants inspired by the attached image. These keep the pixel aesthetic while providing variety. */
        .chain-badge.great {
            background: linear-gradient(180deg,#0b5ea8,#083b6b);
            color: #ffd166;
            border-color: rgba(0,0,0,0.6);
        }

        .chain-badge.amazing {
            background: linear-gradient(180deg,#b33b2b,#8a1f14);
            color: #ffd166;
            border-color: rgba(0,0,0,0.6);
        }

        .chain-badge.stupendous {
            background: linear-gradient(180deg,#8a1f14,#6a0f0f);
            color: #ffd166;
            border-color: rgba(0,0,0,0.6);
        }

        .chain-badge.incredible {
            background: linear-gradient(180deg,#5b2b86,#381a5a);
            color: #ffd166;
            border-color: rgba(0,0,0,0.6);
        }

            /* pixel 'bevel' effect by adding layered box-shadows — subtle and GPU-friendly */
            .chain-badge.great .cb-icon, .chain-badge.amazing .cb-icon, .chain-badge.stupendous .cb-icon, .chain-badge.incredible .cb-icon {
                box-shadow: inset -6px -6px 0 rgba(0,0,0,0.12), 6px 6px 0 rgba(0,0,0,0.12);
            }

        /* small responsive adjustment so badges aren't huge on mobile */
        @media (max-width: 420px) {
            .chain-badge {
                font-size: 11px;
                padding: 8px 12px;
            }

                .chain-badge .cb-icon {
                    width: 34px;
                    height: 28px;
                    font-size: 14px
                }
        }

        /* ---------- Level Complete popup (badge-like) ---------- */
        .level-complete {
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            z-index: 95000;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 14px;
            width: min(720px, 86vw);
            max-width: 92%;
            padding: 20px 28px;
            border-radius: 14px;
            border: 6px solid rgba(0,0,0,0.45);
            background: linear-gradient(180deg,#0b3d91,#08306a);
            color: #ffd166;
            box-shadow: 8px 8px 0 rgba(0,0,0,0.25);
            font-family: 'Press Start 2P', monospace;
            font-size: 20px;
            text-align: center;
            line-height: 1;
            pointer-events: none; /* non-interactive */
            opacity: 0;
            will-change: transform, opacity;
        }

        /* ---------- Game Over popup ---------- */
        .game-over-popup {
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            z-index: 95000;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 10px;
            padding: 30px 40px;
            border-radius: 14px;
            border: 6px solid rgba(0,0,0,0.55);
            background: linear-gradient(180deg,#8a1f14,#6a0f0f);
            color: #ffd166;
            box-shadow: 8px 8px 0 rgba(0,0,0,0.3);
            font-family: 'Press Start 2P', monospace;
            font-size: 20px;
            text-align: center;
            pointer-events: none;
            opacity: 0;
            will-change: transform, opacity;
        }

            /* Inner title and subtitle */
            .game-over-popup .go-title {
                font-size: 24px;
                text-transform: uppercase;
                text-shadow: 3px 3px 0 rgba(0,0,0,0.6);
                letter-spacing: 0.04em;
            }

            .game-over-popup .go-sub {
                font-size: 14px;
                color: #ffe9b0;
                text-shadow: 2px 2px 0 rgba(0,0,0,0.6);
            }

        @keyframes gameOverIn {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }

            60% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.05);
            }

            100% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        @keyframes gameOverOut {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }

            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.95);
            }
        }

        .game-over-popup.show {
            animation: gameOverIn 400ms ease both;
        }

        .game-over-popup.hide {
            animation: gameOverOut 400ms ease forwards;
        }

        /* Inner title larger and tightly tracked */
        .level-complete .lc-title {
            font-size: 20px;
            letter-spacing: 0.02em;
            text-transform: uppercase;
            text-shadow: 3px 3px 0 rgba(0,0,0,0.6);
        }

        /* subtle icon slot (optional) */
        .level-complete .lc-icon {
            width: 56px;
            height: 56px;
            flex: 0 0 auto;
            border-radius: 8px;
            background: rgba(0,0,0,0.12);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: inset -6px -6px 0 rgba(0,0,0,0.12);
        }

        /* Animations */
        @keyframes levelIn {
            0% {
                opacity: 0;
                transform: translate(-50%,-50%) scale(0.8) rotate(-6deg);
            }

            60% {
                opacity: 1;
                transform: translate(-50%,-50%) scale(1.03) rotate(2deg);
            }

            100% {
                opacity: 1;
                transform: translate(-50%,-50%) scale(1) rotate(0deg);
            }
        }

        @keyframes levelOut {
            0% {
                opacity: 1;
                transform: translate(-50%,-50%) scale(1);
            }

            100% {
                opacity: 0;
                transform: translate(-50%,-50%) scale(0.92);
            }
        }

        /* helper classes to control lifecycle */
        .level-complete.show {
            animation: levelIn 420ms cubic-bezier(.2,.9,.2,1) both;
            pointer-events: none;
        }

        .level-complete.hide {
            animation: levelOut 360ms ease forwards;
            pointer-events: none;
        }

        /* Small fixed mute button at bottom-right */
        .bottom-mute {
            position: fixed;
            right: 12px;
            bottom: 12px;
            z-index: 60000;
            padding: 8px 10px;
            font-family: 'Press Start 2P', monospace;
            font-size: 10px;
            border-radius: 8px;
            border: 3px solid rgba(0,0,0,0.18);
            background: linear-gradient(180deg,#ffffff,#e6e3ff);
            color: #0b3d91;
            box-shadow: 3px 3px 0 rgba(0,0,0,0.12);
        }

        .bottom-controls {
            position: fixed;
            right: 12px;
            bottom: 12px;
            z-index: 60000;
            display: flex;
            flex-direction: row;
            gap: 8px; /* space between buttons */
        }

            .bottom-controls .bottom-mute {
                position: static; /* remove the fixed positioning */
            }

        /* Meter styles (10-segment retro pixel bar) */
        .meter {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 8px;
            border-radius: 8px;
            background: linear-gradient(180deg, rgba(0,0,0,0.06), rgba(255,255,255,0.02));
            border: 4px solid rgba(0,0,0,0.25);
            min-width: 140px
        }

        .meter-icon {
            image-rendering: pixelated;
            flex: 0 0 auto
        }

        .meter-segments {
            display: flex;
            gap: 2px;
            align-items: center;
            justify-content: center
        }

            .meter-segments .seg {
                width: 12px;
                height: 12px;
                border: 2px solid #081426;
                background: #2b2b2b;
                box-shadow: inset -3px -3px 0 rgba(0,0,0,0.18);
                border-radius: 1px
            }

                .meter-segments .seg.filled {
                    background: linear-gradient(180deg,#ffd166,#ffb84d);
                    border-color: #081426;
                    box-shadow: inset -5px -5px 0 rgba(0,0,0,0.18)
                }

        .meter-count {
            font-family: 'Press Start 2P',monospace;
            font-size: 10px;
            color: #ffd166;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.55)
        }

        .seg.pop {
            animation: segPop 220ms ease both
        }

        @keyframes segPop {
            0% {
                transform: scale(1)
            }

            50% {
                transform: scale(1.06)
            }

            100% {
                transform: scale(1)
            }
        }



        /* High-score HUD styles (small, unobtrusive) */
        #highScoreHud {
            color: #ffe9b0;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.6);
            opacity: 0.95;
            user-select: none;
        }

            #highScoreHud strong {
                font-weight: 700;
                margin-right: 6px;
                font-size: 11px;
            }

        #highScoreValue {
            font-family: 'Press Start 2P', monospace;
            font-size: 11px;
        }
    
/* Assistant: low-click pulsing for clicks meter */
@keyframes assist-pulse {
  0% { box-shadow: 0 0 0 0 rgba(255, 209, 102, 0.0); transform: scale(1); }
  50% { box-shadow: 0 0 12px 6px rgba(255, 209, 102, 0.18); transform: scale(1.03); }
  100% { box-shadow: 0 0 0 0 rgba(255, 209, 102, 0.0); transform: scale(1); }
}
#clicksMeter.low-warning {
  animation: assist-pulse 900ms ease-in-out infinite;
  border-color: #ffd166;
  transform-origin: center;
}
#clicksMeter.low-warning .segment {
  /* optional: slightly brighten segments */
  filter: drop-shadow(0 2px 2px rgba(0,0,0,0.12));
}
</style>

    <style>
        /* Control trio: compact square buttons in HUD */
        .control-trio {
            display: flex;
            gap: 8px;
            align-items: center;
        }

            .control-trio .ctrl {
                width: 48px;
                height: 40px;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                font-family: 'Press Start 2P', monospace;
                font-size: 12px;
                border-radius: 6px;
                border: 4px solid rgba(0,0,0,0.18);
                background: linear-gradient(180deg,#ffffff,#e6e3ff);
                color: #0b3d91;
                box-shadow: 4px 4px 0 rgba(0,0,0,0.12);
                cursor: pointer;
                padding: 6px;
            }
        /* Slightly smaller on narrow screens */
        @media (max-width:420px) {
            .control-trio .ctrl {
                width: 40px;
                height: 36px;
                font-size: 10px;
            }
        }
    </style>


    <style>
        .small-ctrl {
            width: 100px;
            height: 40px;
            font-family: 'Press Start 2P',monospace;
            font-size: 12px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            border: 4px solid rgba(0,0,0,0.18);
            background: linear-gradient(180deg,#fff,#e6e3ff);
            color: #0b3d91;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.12);
        }

        @media (max-width:420px) {
            .small-ctrl {
                width: 40px;
                height: 36px;
                font-size: 10px;
            }
        }
    </style>


    <!-- AUDIO POPUP CSS INSERTED BY CHATGPT -->
    <style>
        /* ------------ audio popup (matches badge/game-over styling but interactive) ------------- */
        .audio-popup {
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) scale(0.98);
            z-index: 98000;
            width: min(520px, 86vw);
            max-width: 92%;
            padding: 18px 20px;
            border-radius: 12px;
            border: 6px solid rgba(0,0,0,0.45);
            background: linear-gradient(180deg,#0b3d91,#08306a);
            color: #ffd166;
            box-shadow: 8px 8px 0 rgba(0,0,0,0.25);
            font-family: 'Press Start 2P', monospace;
            font-size: 12px;
            text-align: left;
            pointer-events: auto;
            opacity: 0;
            visibility: hidden;
            transition: opacity 220ms ease, transform 220ms ease, visibility 0ms 220ms;
        }

            /* shown */
            .audio-popup.show {
                opacity: 1;
                visibility: visible;
                transform: translate(-50%, -50%) scale(1);
                transition: opacity 220ms ease, transform 220ms ease;
            }

            /* content rows */
            .audio-popup .row {
                display: flex;
                align-items: center;
                gap: 12px;
                margin: 10px 0;
            }

            .audio-popup label {
                width: 130px;
                font-size: 11px;
                color: #ffe9b0;
            }

            .audio-popup input[type="range"] {
                flex: 1;
            }

            .audio-popup .controls {
                display: flex;
                gap: 10px;
                justify-content: flex-end;
                margin-top: 12px;
            }

            /* popup small button */
            .audio-popup .btn {
                border-radius: 8px;
                padding: 8px 12px;
                font-size: 11px;
                border: 4px solid rgba(0,0,0,0.18);
                background: linear-gradient(180deg,#ffffff,#e6e3ff);
                color: #0b3d91;
                box-shadow: 4px 4px 0 rgba(0,0,0,0.12);
                cursor: pointer;
            }

        /* the HUD gear button uses same small-ctrl style already present; optional slight tweak for icon */
        .small-ctrl .gear-icon {
            width: 24px;
            height: 24px;
            display: inline-block;
            color: inherit;
        }

        .restart-icon {
            width: 24px;
            height: 24px;
            image-rendering: pixelated;
            color: inherit;
        }
    </style>
    <!-- END AUDIO POPUP CSS -->

    <style>
        /* Start button icon styling (inserted) */
        .start-icon {
            width: 18px;
            height: 18px;
            display: inline-block;
            vertical-align: middle;
            image-rendering: pixelated;
            color: inherit; /* inherit button color */
        }

        @media (max-width:420px) {
            .start-icon {
                width: 18px;
                height: 18px;
            }
        }
    </style>
</head>

<body>
    <div class="wrap">
        <div class="title-sprite">
            <img src="https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/Gone_Viral_long.png" alt="Gone Viral title" style="width:400px;max-width:80vw;height:auto;display:block;margin-bottom:10px;">
        </div>
        <div id="board" class="board" role="grid" aria-label="game board"><div class="cell" data-index="0"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div></div><div class="cell" data-index="1"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-1"><div class="face-sprite"><img class="face-img" src="./test_files/virus2.png" alt="virus" style="transform: scale(0.6); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="2"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div></div><div class="cell" data-index="3"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-0"><div class="face-sprite"><img class="face-img" src="./test_files/Test_pixel.png" alt="virus" style="transform: scale(0.4); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="4"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-3"><div class="face-sprite"><img class="face-img" src="./test_files/virus4.png" alt="virus" style="transform: scale(1); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="5"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div></div><div class="cell" data-index="6"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-1"><div class="face-sprite"><img class="face-img" src="./test_files/virus2.png" alt="virus" style="transform: scale(0.6); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="7"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div></div><div class="cell" data-index="8"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-2"><div class="face-sprite"><img class="face-img" src="./test_files/virus3.png" alt="virus" style="transform: scale(0.8); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="9"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-0"><div class="face-sprite"><img class="face-img" src="./test_files/Test_pixel.png" alt="virus" style="transform: scale(0.4); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="10"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-1"><div class="face-sprite"><img class="face-img" src="./test_files/virus2.png" alt="virus" style="transform: scale(0.6); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="11"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-1"><div class="face-sprite"><img class="face-img" src="./test_files/virus2.png" alt="virus" style="transform: scale(0.6); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="12"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div></div><div class="cell" data-index="13"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-0"><div class="face-sprite"><img class="face-img" src="./test_files/Test_pixel.png" alt="virus" style="transform: scale(0.4); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="14"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-3"><div class="face-sprite"><img class="face-img" src="./test_files/virus4.png" alt="virus" style="transform: scale(1); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="15"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div></div><div class="cell" data-index="16"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div></div><div class="cell" data-index="17"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-1"><div class="face-sprite"><img class="face-img" src="./test_files/virus2.png" alt="virus" style="transform: scale(0.6); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="18"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-3"><div class="face-sprite"><img class="face-img" src="./test_files/virus4.png" alt="virus" style="transform: scale(1); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="19"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-3"><div class="face-sprite"><img class="face-img" src="./test_files/virus4.png" alt="virus" style="transform: scale(1); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="20"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div></div><div class="cell" data-index="21"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div></div><div class="cell" data-index="22"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div></div><div class="cell" data-index="23"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-1"><div class="face-sprite"><img class="face-img" src="./test_files/virus2.png" alt="virus" style="transform: scale(0.6); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="24"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-3"><div class="face-sprite"><img class="face-img" src="./test_files/virus4.png" alt="virus" style="transform: scale(1); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="25"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-2"><div class="face-sprite"><img class="face-img" src="./test_files/virus3.png" alt="virus" style="transform: scale(0.8); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="26"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div></div><div class="cell" data-index="27"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-3"><div class="face-sprite"><img class="face-img" src="./test_files/virus4.png" alt="virus" style="transform: scale(1); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="28"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div></div><div class="cell" data-index="29"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-1"><div class="face-sprite"><img class="face-img" src="./test_files/virus2.png" alt="virus" style="transform: scale(0.6); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="30"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div></div><div class="cell" data-index="31"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-0"><div class="face-sprite"><img class="face-img" src="./test_files/Test_pixel.png" alt="virus" style="transform: scale(0.4); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="32"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-0"><div class="face-sprite"><img class="face-img" src="./test_files/Test_pixel.png" alt="virus" style="transform: scale(0.4); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="33"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-0"><div class="face-sprite"><img class="face-img" src="./test_files/Test_pixel.png" alt="virus" style="transform: scale(0.4); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="34"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div><div class="virus virus--size-2"><div class="face-sprite"><img class="face-img" src="./test_files/virus3.png" alt="virus" style="transform: scale(0.8); transform-origin: center center;"></div><div class="stain"></div></div></div><div class="cell" data-index="35"><div class="petri"><img src="./test_files/petri dish.png" alt="petri"></div></div></div>
        <div class="hud">
            <div class="hud-row">
                <div class="level-box">Level: <span id="screens">1</span></div>
                <div class="small scorebox">
                    <div class="score-line">Score: <span id="score">0</span></div>
                    <div class="high-line">High: <span id="highScoreValue">0</span></div>
                </div>
            </div>

            <div class="small meter" id="clicksMeter">
                <img class="meter-icon" src="https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/nanobot.png" alt="Nano Bot Icon" width="28" height="28">

                <div class="meter-segments" aria-hidden="true"><div class="seg filled pop" data-idx="0"></div><div class="seg filled pop" data-idx="1"></div><div class="seg filled pop" data-idx="2"></div><div class="seg filled pop" data-idx="3"></div><div class="seg filled pop" data-idx="4"></div><div class="seg" data-idx="5"></div><div class="seg" data-idx="6"></div><div class="seg" data-idx="7"></div><div class="seg" data-idx="8"></div><div class="seg" data-idx="9"></div></div>
                <div class="meter-count"> <span id="clicks">10</span></div>
            </div>

            <div class="control-trio" role="group" aria-label="Controls">



                <button id="startBtn" class="ctrl small-ctrl" aria-label="S">
                    <svg class="start-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 1200" preserveAspectRatio="xMidYMid meet" aria-hidden="true" focusable="false">
                        <path fill="currentColor" d="M364.798,80.329l-30.419,790.778
    c-40.935-21.007-92.292-30.096-146.179-22.449C72.007,865.114-11.66,952.766,1.33,1044.407
    c12.992,91.647,117.714,152.585,233.902,136.124c103.119-14.613,180.524-85.303,187.557-165.075l0.022,0.045
    c0.016-0.181,0.026-0.452,0.042-0.656c0.173-2.026,0.271-4.08,0.346-6.119c4.327-82.368,30.815-708.026,30.815-708.026
    l652.416-67.219l-29.467,563.479c-41.867-23.303-95.68-33.684-152.264-25.665c-116.192,16.473-199.854,104.105-186.863,195.759
    c12.986,91.639,117.709,152.587,233.901,136.107c105.313-14.906,183.777-88.319,187.895-170.171l0.05-0.05
    C1161.89,896.157,1198.7,46.799,1200,16.784L364.798,80.329z" />
                    </svg>
                </button>
                <button id="restart" class="ctrl small-ctrl" aria-label="Restart">
                    <svg class="restart-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                              d="M8.87 10.5046L10.8204 12.4504L9.76045 13.511L6 9.75456L9.76045 5.99805L10.8204 7.05871L8.87 9.00456H18V18H11.9532V16.5H16.5V10.5046H8.87Z"
                              fill="currentColor" />
                    </svg>
                </button>

                <button id="audioBtn" class="ctrl small-ctrl" aria-label="Audio Settings" title="Audio Settings">
                    <svg class="gear-icon" viewBox="0 0 24 24" width="24" height="24" xmlns="http://www.w3.org/2000/svg"><rect x="0" fill="none" width="24" height="24" /><g><path d="M20 12c0-.568-.06-1.122-.174-1.656l1.834-1.612-2-3.464-2.322.786c-.82-.736-1.787-1.308-2.86-1.657L14 2h-4l-.48 2.396c-1.07.35-2.04.92-2.858 1.657L4.34 5.268l-2 3.464 1.834 1.612C4.06 10.878 4 11.432 4 12s.06 1.122.174 1.656L2.34 15.268l2 3.464 2.322-.786c.82.736 1.787 1.308 2.86 1.657L10 22h4l.48-2.396c1.07-.35 2.038-.92 2.858-1.657l2.322.786 2-3.464-1.834-1.613c.113-.535.174-1.09.174-1.657zm-8 4c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z" / fill="currentColor"></g></svg>
                </button>
                <!-- help / how-to-play button -->
                <button id="helpBtn" class="ctrl small-ctrl" aria-label="How to Play" title="How to Play">?</button>



            </div>
            <div id="assist-badge" class="assist-badge" aria-live="polite" aria-atomic="true" title="Lab Assistant" role="button">
                <!-- small inline SVG as fallback sprite (small footprint) -->
                <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='64' height='64' viewBox='0 0 24 24'><rect rx='4' width='24' height='24' fill='%23000' opacity='0.4'/><circle cx='8.5' cy='10' r='1.6' fill='%23ffd166'/><circle cx='15.5' cy='10' r='1.6' fill='%23ffd166'/><rect x='6' y='14' width='12' height='1.6' rx='0.8' fill='%23ffd166' opacity='0.9'/></svg>" alt="assistant" />
            </div>
            <div id="assist-bubble" class="assist-bubble" role="status" aria-hidden="true">
                <div id="assist-text">...</div>
            </div>
        </div>
    </div>

    <script>
        // Difficulty tuning: base density and growth per screen (fraction 0..1)
        const BASE_DENSITY = 0.60;       // fraction of cells initially filled (0..1)
        const DENSITY_GROWTH = 0.0;   // fraction added each screenPassed;   // fraction added each screenPassed

        // Wrap everything that queries DOM in DOMContentLoaded so elements exist before we attach listeners
        document.addEventListener('DOMContentLoaded', () => {


            // initialize high score HUD
            try { highScoreEl = document.getElementById('highScoreValue'); if (highScoreEl) highScoreEl.textContent = String(highScore); } catch (e) { }
            // Full game script preserved from original with badge/confetti and 8-bit icons added
            const ROWS = 6, COLS = 6, MAX_SIZE = 3, MAX_CLICKS = 20;

            // ---------- Render scheduling (prevents redundant reflows) ----------
            let renderQueued = false;
            function scheduleRender() {
                if (renderQueued) return;
                renderQueued = true;
                // use setTimeout with 0 delay instead of RAF for faster perceived updates
                setTimeout(() => {
                    try { render(); } catch (e) { console.warn('render failed', e); }
                    renderQueued = false;
                }, 0);
            }


            const SPRITE_URLS = [
                'https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/Test_pixel.png',
                'https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/virus2.png',
                'https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/virus3.png',
                'https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/virus4.png'
            ];
            const PETRI_URL = 'https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/petri%20dish.png';
            const SFX_URLS = {
                pop: 'https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/pop2.mp3',
                grow: 'https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/grow.mp3',
                fill: 'https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/bubblefill2.mp3',
                win: 'https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/win2.mp3',
                lose: 'https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/lose2.mp3'
            };

            // Background music playlist (hard-wired) — will be started on the user's first tap
            const MUSIC_PLAYLIST = [
                'https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/Voltaic.mp3',
                'https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/Robobozo.mp3'
            ];
            let musicOrder = [];
            let musicIndex = 0;
            let musicAudio = null;
            let musicSilenceMs = 2000; // 2 seconds silence between tracks
            let musicEnabled = true;

            let sfxCache = {};
            function createSfx(key) { const url = SFX_URLS[key]; if (!url) return null; try { const a = new Audio(url); a.preload = 'auto'; a.volume = 0.5; a.crossOrigin = 'anonymous'; sfxCache[key] = a; return a; } catch (e) { return null; } }
            function getSfx(key) { return sfxCache[key] || createSfx(key); }
            function playSfx(key) { try { const a = getSfx(key); if (!a) return; a.currentTime = 0; const p = a.play(); if (p && p.catch) p.catch(() => { }); } catch (e) { } }

            function shuffleArray(arr) { for (let i = arr.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1));[arr[i], arr[j]] = [arr[j], arr[i]]; } }
            function prepareMusicOrder() { musicOrder = MUSIC_PLAYLIST.slice(); shuffleArray(musicOrder); musicIndex = 0; }
            function playNextMusicTrack() {
                if (!musicEnabled) return; if (musicAudio) { try { musicAudio.pause(); musicAudio.src = ''; } catch (e) { } musicAudio = null; }
                if (musicOrder.length === 0) prepareMusicOrder(); const url = musicOrder[musicIndex % musicOrder.length]; musicAudio = new Audio(url); musicAudio.volume = 0.20; musicAudio.preload = 'auto'; musicAudio.crossOrigin = 'anonymous';
                const onEnded = () => { // schedule next after silence
                    musicAudio.removeEventListener('ended', onEnded);
                    setTimeout(() => { musicIndex = (musicIndex + 1) % musicOrder.length; playNextMusicTrack(); }, musicSilenceMs);
                };
                musicAudio.addEventListener('ended', onEnded);
                const playPromise = musicAudio.play(); if (playPromise && playPromise.catch) { playPromise.catch(() => { /* ignore */ }); }
            }
            // ---- audio settings hookup inserted by ChatGPT v4 ----
            try {
                // expose musicVolume and allMuted into local scope if not present
                if (typeof musicVolume === 'undefined') var musicVolume = (window.musicVolume !== undefined) ? window.musicVolume : 0.20;
                if (typeof allMuted === 'undefined') var allMuted = (window.allMuted !== undefined) ? window.allMuted : false;
                window.musicVolume = window.musicVolume || musicVolume;
                window.allMuted = window.allMuted || allMuted;

                // wrap playNextMusicTrack so newly created musicAudio picks up volume/mute
                try {
                    const _origPlayNext = playNextMusicTrack;
                    playNextMusicTrack = function () {
                        const res = _origPlayNext.apply(this, arguments);
                        try {
                            if (typeof musicAudio !== 'undefined' && musicAudio) {
                                musicAudio.volume = (typeof musicVolume !== 'undefined') ? musicVolume : (window.musicVolume || 0.20);
                                musicAudio.muted = !!(typeof allMuted !== 'undefined' ? allMuted : window.allMuted);
                            }
                        } catch (e) { }
                        return res;
                    };
                } catch (e) { }

                // wire UI sliders directly to local musicAudio and to local vars
                const mSlider = document.getElementById('musicVol');
                const sSlider = document.getElementById('sfxVol');
                const mVal = document.getElementById('musicVolVal');
                const sVal = document.getElementById('sfxVolVal');
                const popupMute = document.getElementById('popupMute');

                if (mSlider) {
                    // initialize slider
                    mSlider.value = String((typeof musicAudio !== 'undefined' && musicAudio && musicAudio.volume !== undefined) ? musicAudio.volume : (window.musicVolume || 0.20));
                    if (mVal) mVal.textContent = Math.round(Number(mSlider.value) * 100) + '%';
                    mSlider.addEventListener('input', function (e) {
                        var v = Number(e.target.value);
                        try { musicVolume = v; } catch (e) { }
                        window.musicVolume = v;
                        if (typeof musicAudio !== 'undefined' && musicAudio) {
                            try { musicAudio.volume = v; } catch (e) { }
                        }
                    });
                }

                if (sSlider) {
                    sSlider.value = String(window.sfxVolume || 0.50);
                    if (sVal) sVal.textContent = Math.round(Number(sSlider.value) * 100) + '%';
                }

                if (popupMute) {
                    // make popup mute call the page's existing mute button if present
                    popupMute.addEventListener('click', function () {
                        try {
                            var mainMute = document.getElementById('mute');
                            if (mainMute && typeof mainMute.click === 'function') {
                                mainMute.click();
                            } else {
                                // fallback: toggle local variables and apply
                                var nm = !((typeof allMuted !== 'undefined') ? allMuted : window.allMuted);
                                try { allMuted = nm; } catch (e) { }
                                window.allMuted = nm;
                                if (typeof musicAudio !== 'undefined' && musicAudio) try { musicAudio.muted = !!nm; } catch (e) { }
                                // also mute sfx cache
                                try { if (typeof sfxCache !== 'undefined' && sfxCache) Object.values(sfxCache).forEach(function (a) { if (a) a.muted = !!nm; }); } catch (e) { }
                            }
                        } catch (e) { }
                    });
                }

            } catch (e) { }
            // ---- end inserted block ----

            function startBackgroundMusic() { try { if (!musicOrder.length) prepareMusicOrder(); playNextMusicTrack(); } catch (e) { console.warn('startBackgroundMusic failed', e); } }
            function stopBackgroundMusic() { try { if (musicAudio) { musicAudio.pause(); musicAudio = null; } } catch (e) { } }

            // Game difficulty & state
            let clicksLeft = 10, screensPassed = 0, totalScore = 0;
            let outOfClicksShown = false;
            let state = new Array(ROWS * COLS).fill(null);
            let inputLocked = false;

            // Move DOM element lookups inside DOMContentLoaded
            const boardEl = document.getElementById('board');
            const clicksEl = document.getElementById('clicks');
            const screensEl = document.getElementById('screens');
            const scoreEl = document.getElementById('score');


            // High-score persistence (localStorage)
            const highScoreKey = 'goneViral_highScore';
            let highScore = Number(localStorage.getItem(highScoreKey) || 0);
            let highScoreEl = null;

            function updateHUD() {

                // ensure high score element is available
                if (!highScoreEl) try { highScoreEl = document.getElementById('highScoreValue'); } catch (e) { }
                if (clicksEl) clicksEl.textContent = clicksLeft; if (screensEl) screensEl.textContent = (screensPassed + 1); if (scoreEl) scoreEl.textContent = totalScore;
                // --- high-score handling ---
                if (typeof highScore !== 'number') highScore = 0;
                if (totalScore > highScore) {
                    highScore = totalScore;
                    try { localStorage.setItem(highScoreKey, String(highScore)); } catch (e) { }
                    if (highScoreEl) highScoreEl.textContent = String(highScore);
                }
                // Update the floating score box (5 digits, zero-padded)
                
const disp = document.getElementById('scoreDisplay');
if (disp) {
    const s = String(totalScore).padStart(5, '0').slice(-5);
    disp.textContent = s;
}

// Always update meter visuals and notify assistant when clicks are low
try {
    const meter = document.getElementById('clicksMeter');
    if (meter) {
        
if (meter) {
    if (clicksLeft <= 2) {
        if (!meter.classList.contains('low-warning')) {
            meter.classList.add('low-warning');
            // restart animation by forcing reflow
            void meter.offsetWidth;
        }
    } else {
        meter.classList.remove('low-warning');
    }
}

    }

    // Assistant low-click guard: trigger once when clicks drop to <=2
    if (typeof window._assistantLowShown === 'undefined') window._assistantLowShown = false;
    if (clicksLeft <= 2 && !window._assistantLowShown) {
        try { if (window.Assistant && Assistant.emit) Assistant.emit('lowClicks', { clicksLeft }); } catch(e) {}
        window._assistantLowShown = true;
    }
    if (clicksLeft > 2 && window._assistantLowShown) {
        window._assistantLowShown = false;
    }
} catch (e) {
    console.warn('low-clicks HUD update failed', e);
}

                // update pixel meter visualization (10 segments)
                try { updateClicksMeter(clicksLeft); } catch (e) { }
            }

            // Unified reset used by the Game Over persistent popup and restart wiring
            function performGameReset() {
                try {
                    screensPassed = 0;
                    totalScore = 0;
                    randomizeBoard(false);
                    updateHUD();
                    outOfClicksShown = false;
                } catch (e) { console.warn('performGameReset failed', e); }
            }


            // ---------- Level complete popup helper ----------
            function showLevelComplete(opts = {}) {
                // opts.title default
                const title = opts.title || 'LEVEL COMPLETE';
                const duration = (typeof opts.duration === 'number') ? opts.duration : 1400; // ms visible before fade out
                try {
                    // create element
                    const el = document.createElement('div');
                    el.className = 'level-complete';
                    el.setAttribute('role', 'status');
                    el.setAttribute('aria-live', 'polite');
                    el.innerHTML = `
                              <div class="lc-icon" aria-hidden="true">${getRetroIconSVG('pixel-star')}</div>
                              <div class="lc-title">${title}</div>
                            `;
                    document.body.appendChild(el);

                    // force reflow then show
                    void el.offsetWidth;
                    el.classList.add('show');
                    try { if (window.Assistant) Assistant.emit && Assistant.emit('levelComplete'); } catch (e) { }


                    // schedule hide
                    setTimeout(() => {
                        try {
                            el.classList.remove('show');
                            el.classList.add('hide');
                            el.addEventListener('animationend', function onEnd() {
                                el.removeEventListener('animationend', onEnd);
                                try { el.remove(); } catch (e) { }
                            });
                        } catch (e) { }
                    }, duration);

                } catch (e) {
                    console.warn('showLevelComplete error', e);
                }
            }

            // ---------- Game Over popup helper ----------

            function showGameOverPopup(opts = {}) {
                // opts: { title, subtitle, duration (ms), persistent (bool) }
                const title = opts.title || 'GAME OVER';
                const subtitle = opts.subtitle || 'Try Again';
                const duration = (typeof opts.duration === 'number') ? opts.duration : 1800;
                const persistent = !!opts.persistent;

                try {
                    // create element
                    const el = document.createElement('div');
                    el.className = 'game-over-popup';
                    el.setAttribute('role', 'alert');
                    el.style.pointerEvents = persistent ? 'auto' : 'none';
                    el.innerHTML = `
                              <div class="go-title">${title}</div>
                              <div class="go-sub">${subtitle}</div>
                            `;
                    document.body.appendChild(el);
  // Make Game Over popup clickable to restart (Option A)
  try {
    el.style.cursor = 'pointer';
    el.title = 'Click to restart';
    el.addEventListener('click', function restartFromPopup(ev){
      try {
        // reset game state
        if (typeof performGameReset === 'function') performGameReset();
        // remove popup element if still present
        try { if (el && el.parentNode) el.parentNode.removeChild(el); } catch(e){}
        // notify assistant (optional)
        try { if (window.Assistant && Assistant.emit) Assistant.emit('levelComplete', { title: 'Restarted after Game Over' }); } catch(e){}
      } catch(e) { console.warn('restart click handler failed', e); }
    }, { once: true });
  } catch (e) { console.warn('could not attach restart click handler', e); }

                    void el.offsetWidth;
                    el.classList.add('show');
                    try { if (window.Assistant) Assistant.emit && Assistant.emit('gameOver', { title: title, subtitle: subtitle }); } catch (e) { }


                    if (persistent) {
                        // leave it on screen until user clicks the existing #restart button
                        // ensure restart button exists and wire a one-time handler
                        const restartBtn = document.getElementById('restart');
                        const cleanup = () => {
                            try {
                                if (el) {
                                    el.classList.remove('show');
                                    el.classList.add('hide');
                                    el.addEventListener('animationend', () => { try { el.remove(); } catch (e) { } }, { once: true });
                                }
                            } catch (e) { }
                        };
                        if (restartBtn) {
                            // avoid double-wiring
                            if (!restartBtn._gop_wired) {
                                restartBtn._gop_wired = true;
                                restartBtn.addEventListener('click', function onRestartFromGOP(e) {
                                    // cleanup popup and perform reset
                                    cleanup();
                                    try {
                                        // clear the outOfClicksShown guard so future gameovers can show
                                        outOfClicksShown = false;
                                    } catch (e) { }
                                    // call a unified reset if present
                                    if (typeof performGameReset === 'function') {
                                        try { performGameReset(); } catch (e) { }
                                    } else {
                                        try {
                                            screensPassed = 0;
                                            totalScore = 0;
                                            randomizeBoard(false);
                                            updateHUD();
                                        } catch (e) { }
                                    }
                                    // remove this handler flag (keep listener but it's idempotent)
                                });
                            }
                        } else {
                            // If no restart button, leave the popup until manually removed
                            console.warn('showGameOverPopup: persistent requested but #restart button not found.');
                        }
                        return;
                    }

                    // non-persistent: Hide and cleanup after delay
                    setTimeout(() => {
                        try {
                            el.classList.remove('show');
                            el.classList.add('hide');
                            el.addEventListener('animationend', () => el.remove(), { once: true });
                        } catch (e) { }
                    }, duration);
                } catch (e) {
                    console.warn('showGameOverPopup error', e);
                }
            }



            // Create and update meter functions
            function createClicksMeter(segmentsCount = 10) { const container = document.querySelector('.meter-segments'); if (!container) return; container.innerHTML = ''; for (let i = 0; i < segmentsCount; i++) { const s = document.createElement('div'); s.className = 'seg'; s.dataset.idx = i; container.appendChild(s); } }
            function updateClicksMeter(clicks) { const container = document.querySelector('.meter-segments'); if (!container) return; const segs = Array.from(container.children); const segCount = segs.length || 10; const toFill = Math.round((clicks / MAX_CLICKS) * segCount); segs.forEach((el, i) => { const should = i < toFill; if (should && !el.classList.contains('filled')) { el.classList.add('filled'); el.classList.remove('pop'); void el.offsetWidth; el.classList.add('pop'); } else if (!should && el.classList.contains('filled')) { el.classList.remove('filled'); el.classList.remove('pop'); } }); }

            function shuffle(arr) { for (let i = arr.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1));[arr[i], arr[j]] = [arr[j], arr[i]]; } }

            // ---------- Level-adaptive size-mix (two-phase) ----------
            // Start / middle / end mixes. Arrays should sum to 1 but code will normalize defensively.
            const SIZE_MIX_START = [0.10, 0.25, 0.30, 0.35]; // early levels: favor large (size 3)
            const SIZE_MIX_EVEN = [0.25, 0.25, 0.25, 0.25]; // middle: even distribution
            const SIZE_MIX_END = [0.35, 0.30, 0.25, 0.10]; // late: favor small (size 0)

            // Levels controlling the interpolation durations
            const LEVELS_TO_EVEN = 5;   // START -> EVEN over these many levels
            const LEVELS_TO_END = 12;  // EVEN -> END over these many levels (after the above)

            // Helper: linear interpolation between two arrays
            function lerpArrays(a, b, t) {
                const out = new Array(Math.max(a.length, b.length));
                for (let i = 0; i < out.length; i++) {
                    const ai = (i < a.length) ? a[i] : 0;
                    const bi = (i < b.length) ? b[i] : 0;
                    out[i] = ai + (bi - ai) * t;
                }
                return out;
            }

            // Debug HUD: create an overlay element to show the current interpolated mix
            function ensureSizeMixDebugElement() {
                let el = document.getElementById('sizeMixDebug');
                if (!el) {
                    el = document.createElement('div');
                    el.id = 'sizeMixDebug';
                    el.style.position = 'fixed';
                    el.style.right = '12px';
                    el.style.top = '12px';
                    el.style.zIndex = 99999;
                    el.style.background = 'rgba(0,0,0,0.65)';
                    el.style.color = '#ffd166';
                    el.style.padding = '8px 10px';
                    el.style.fontFamily = 'monospace';
                    el.style.fontSize = '12px';
                    el.style.borderRadius = '8px';
                    el.style.pointerEvents = 'none';
                    document.body.appendChild(el);
                }
                return el;
            }

            // Weighted sampler that adapts based on screensPassed (levels completed)
            function sampleSizeRandom() {
                const dims = MAX_SIZE + 1;
                // helper to ensure arrays are the right length
                function ensureLen(arr) {
                    const out = arr.slice(0, dims);
                    while (out.length < dims) out.push(0);
                    return out;
                }
                const S = ensureLen(SIZE_MIX_START);
                const M = ensureLen(SIZE_MIX_EVEN);
                const E = ensureLen(SIZE_MIX_END);

                let weights;
                if (typeof screensPassed === 'undefined') {
                    // fallback to uniform if screensPassed not yet defined
                    weights = new Array(dims).fill(1 / dims);
                } else if (screensPassed <= LEVELS_TO_EVEN) {
                    const t1 = LEVELS_TO_EVEN === 0 ? 1 : (screensPassed / LEVELS_TO_EVEN);
                    weights = lerpArrays(S, M, t1);
                } else if (screensPassed <= LEVELS_TO_EVEN + LEVELS_TO_END) {
                    const local = screensPassed - LEVELS_TO_EVEN;
                    const t2 = LEVELS_TO_END === 0 ? 1 : (local / LEVELS_TO_END);
                    weights = lerpArrays(M, E, t2);
                } else {
                    weights = E.slice();
                }

                // Normalize defensively
                const sum = weights.reduce((a, b) => a + b, 0) || 1;
                for (let i = 0; i < weights.length; i++) weights[i] = weights[i] / sum;

                // Update debug HUD with current mix
                try { updateSizeMixDebug(weights, (screensPassed || 0) + 1); } catch (e) { }

                // Weighted sample by cumulative weights
                let r = Math.random();
                for (let i = 0; i < weights.length; i++) {
                    if (r < weights[i]) return i;
                    r -= weights[i];
                }
                return weights.length - 1;
            }


            function randomizeBoard(preserveClicks = false) {
                state.fill(null); if (!preserveClicks) clicksLeft = 10; const total = ROWS * COLS;
                const target = Math.round(total * Math.min(0.95, BASE_DENSITY + screensPassed * DENSITY_GROWTH)); const idx = Array.from({ length: total }, (_, i) => i); shuffle(idx); for (let k = 0; k < target; k++) { state[idx[k]] = sampleSizeRandom(); } scheduleRender(); updateHUD();
            }

            function findNextBubble(index, dr, dc) { let r = Math.floor(index / COLS), c = index % COLS; while (true) { r += dr; c += dc; if (r < 0 || r >= ROWS || c < 0 || c >= COLS) return null; const i = r * COLS + c; if (state[i] !== null) return i; } }

            function createPetriElement() { const pet = document.createElement('div'); pet.className = 'petri'; if (PETRI_URL) { const img = document.createElement('img'); img.src = PETRI_URL; img.alt = 'petri'; pet.appendChild(img); } return pet; }

            function createVirusContainer(size) { const container = document.createElement('div'); container.className = 'virus virus--size-' + size; const sprite = document.createElement('div'); sprite.className = 'face-sprite'; const img = document.createElement('img'); img.className = 'face-img'; img.src = SPRITE_URLS[Math.max(0, Math.min(3, size))]; img.alt = 'virus'; const sizeScales = [0.4, 0.6, 0.8, 1.0]; img.style.transform = 'scale(' + sizeScales[Math.max(0, Math.min(3, size))] + ')'; img.style.transformOrigin = 'center center'; sprite.appendChild(img); container.appendChild(sprite); const stain = document.createElement('div'); stain.className = 'stain'; container.appendChild(stain); return container; }

            function render() {
                boardEl.innerHTML = ''; for (let i = 0; i < ROWS * COLS; i++) {
                    const val = state[i]; const gridCell = document.createElement('div'); gridCell.className = 'cell'; gridCell.dataset.index = i; // petri underlay
                    const pet = createPetriElement(); gridCell.appendChild(pet);
                    if (val !== null) { const container = createVirusContainer(val); gridCell.appendChild(container); }
                    boardEl.appendChild(gridCell);
                }
                updateHUD();
                const remaining = state.filter(x => x !== null).length;

                if (remaining === 0) {
                    // single, unified "level complete" path
                    clicksLeft = Math.min(MAX_CLICKS, clicksLeft + 1);
                    playSfx('win');
                    screensPassed += 1;
                    updateHUD();

                    try { showLevelComplete({ title: 'LEVEL COMPLETE', duration: 1400 }); } catch (e) { }

                    // wait a moment for the popup/animation, then new board
                    setTimeout(() => randomizeBoard(true), 420);
                }


            }

            // Particle pool
            const PARTICLE_POOL = [];
            // ---------- Sprite-based particle implementation (replacement) ----------
            const PARTICLE_SPRITE = 'https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/antibody.png';

            // Create a pooled particle element (an <img> inside a .particle wrapper)
            function makeAntibodyParticle(sizeVariant = 'normal', rotationDeg = 0) {
                const wrapper = document.createElement('div');
                wrapper.className = 'particle';
                if (sizeVariant === 'small') wrapper.classList.add('small');
                else if (sizeVariant === 'large') wrapper.classList.add('large');

                // create img child for the sprite
                const img = document.createElement('img');
                img.src = PARTICLE_SPRITE;
                img.alt = '';
                img.draggable = false;
                wrapper.appendChild(img);

                // runtime flags
                wrapper._inUse = false;
                wrapper._releaseTimeout = null;

                // safety: transitionend cleanup (so we can release when transform finishes)
                wrapper.addEventListener('transitionend', (ev) => {
                    // We only care about transform/opacity transitions finishing
                    if (!wrapper._inUse) return;
                    if (ev.propertyName === 'transform' || ev.propertyName === 'opacity') {
                        // nothing here by default; release is handled by animateParticleTo's timeout
                    }
                });

                return wrapper;
            }

            function getParticleFromPool(sizeVariant = 'normal', rotationDeg = 0) {
                for (let i = 0; i < PARTICLE_POOL.length; i++) {
                    const p = PARTICLE_POOL[i];
                    if (!p._inUse) {
                        p._inUse = true;
                        p.classList.remove('small', 'large');
                        if (sizeVariant === 'small') p.classList.add('small');
                        else if (sizeVariant === 'large') p.classList.add('large');
                        p.style.transition = ''; // reset transition
                        p.style.opacity = '1';
                        p.style.willChange = 'transform, opacity';

                        // --- assign randomized start rotation and optional flip ---
                        const randExtra = (Math.random() - 0.5) * 120; // ±60° jitter
                        const startRot = (rotationDeg + randExtra + 36000) % 360; // normalize
                        p._rotStart = startRot;

                        // sometimes flip the sprite horizontally (~20%)
                        p._flip = (Math.random() < 0.20) ? -1 : 1;

                        // apply the starting transform (centered positioning is preserved)
                        p.style.transform = `translate3d(0px, 0px, 0) translate(-50%,-50%) scale(0.9) rotate(${startRot}deg) scaleX(${p._flip})`;

                        return p;
                    }
                }

                // create new element if pool exhausted
                const np = makeAntibodyParticle(sizeVariant, rotationDeg);
                np._inUse = true;
                // apply same randomized rotation/flip for new node
                const randExtra = (Math.random() - 0.5) * 120;
                const startRot = (rotationDeg + randExtra + 36000) % 360;
                np._rotStart = startRot;
                np._flip = (Math.random() < 0.20) ? -1 : 1;
                np.style.transform = `translate3d(0px, 0px, 0) translate(-50%,-50%) scale(0.9) rotate(${startRot}deg) scaleX(${np._flip})`;

                PARTICLE_POOL.push(np);
                return np;
            }


            function releaseParticle(p) {
                try {
                    p._inUse = false;
                    // clear will-change so the compositor can drop the layer
                    p.style.willChange = 'auto';
                    // reset transition so it doesn't animate accidentally when reused
                    p.style.transition = '';
                    // set invisible
                    p.style.opacity = '0';
                    // optional: remove from DOM to reduce nodes if your pool grows huge
                    // if(document.body.contains(p)) p.remove();
                } catch (e) { /* ignore */ }
            }

            function animateParticleTo(pel, sx, sy, tx, ty, duration, onArrival) {
                // Ensure appended to DOM
                if (!document.body.contains(pel)) document.body.appendChild(pel);

                // compute integer deltas for crisp translation
                const dx = Math.round(tx - sx);
                const dy = Math.round(ty - sy);

                // Place at start coords instantly (no transition)
                pel.style.transition = 'none';
                pel.style.left = sx + 'px';
                pel.style.top = sy + 'px';

                // ensure starting transform honors stored rotation/flip if present
                const startRot = (typeof pel._rotStart === 'number') ? pel._rotStart : (Math.random() * 360);
                const flip = (typeof pel._flip === 'number') ? pel._flip : 1;
                pel.style.transform = `translate3d(0px, 0px, 0) translate(-50%,-50%) scale(0.9) rotate(${startRot}deg) scaleX(${flip})`;

                // flush styles
                void pel.offsetWidth;

                // RANDOMIZE spin: large variance gives distinctive motion
                const maxSpin = 720; // change down to 180 for milder spin
                const spinVariance = (Math.random() - 0.5) * (maxSpin * 2); // -maxSpin..+maxSpin
                const endRot = startRot + spinVariance;

                // small random scale variance for organic look
                const scale = 1 + (Math.random() * 0.08);

                // clamp duration
                const dur = Math.max(120, Math.min(600, Math.round(duration)));

                // apply transitions (transform for travel+rotation, opacity for fade)
                pel.style.transition = `transform ${dur}ms cubic-bezier(.2,.8,.2,1), opacity ${Math.max(80, Math.min(dur, 900))}ms linear`;

                // Target transform: translate by dx,dy and rotate to endRot; keep flip via scaleX
                pel.style.transform = `translate3d(${dx}px, ${dy}px, 0) translate(-50%,-50%) scale(${scale}) rotate(${endRot}deg) scaleX(${flip})`;

                // Fade & shrink: start fade at ~60% of travel and shrink at same time
                const fadeDelay = Math.max(20, dur * 0.6);
                const fadeTimeout = setTimeout(() => {
                    try {
                        pel.style.opacity = '0';
                        // shrink a bit as it fades out
                        const currentTransform = pel.style.transform || '';
                        if (!currentTransform.includes('scale(')) {
                            pel.style.transform += ' scale(0.7)';
                        } else {
                            // append a quick transform transition for shrink
                            pel.style.transition = pel.style.transition + ', transform 180ms ease-in';
                            pel.style.transform = currentTransform.replace(/scale\([^)]*\)/, 'scale(0.7)');
                        }
                    } catch (e) { }
                }, fadeDelay);

                // Cleanup and callback after travel ends (dur + small buffer)
                clearTimeout(pel._releaseTimeout);
                pel._releaseTimeout = setTimeout(() => {
                    try { if (onArrival) onArrival(); } catch (e) { }
                    clearTimeout(fadeTimeout);
                    // ensure invisible and release back to pool
                    pel.style.opacity = '0';
                    releaseParticle(pel);
                }, dur + 40);
            }



            function emitDirectionalParticles(cellIndex, tracker) {
                const originCell = boardEl.querySelector(`[data-index='${cellIndex}']`);
                if (!originCell) return;

                // conservative cap to prevent accidental floods on low-end devices
                const MAX_ACTIVE_PARTICLES = 20;
                const activeCount = PARTICLE_POOL.filter(p => p && p._inUse).length;
                if (activeCount >= MAX_ACTIVE_PARTICLES) return;

                const r = originCell.getBoundingClientRect();
                const sx = r.left + r.width / 2;
                const sy = r.top + r.height / 2;

                // directions: dr, dc, ox, oy (ox/oy used as fallback travel direction)
                const dirs = [
                    [-1, 0, 0, -1], // up
                    [1, 0, 0, 1],   // down
                    [0, -1, -1, 0], // left
                    [0, 1, 1, 0]    // right
                ];

                // For narrow screens we still only spawn 1 per direction; this reduces visual noise
                // but retains the single directional particle behavior requested.
                const perDirection = 1;

                const hitTargets = new Set();

                dirs.forEach((d, dirIdx) => {
                    const [dr, dc, ox, oy] = d;
                    // find the closest bubble in this direction (if any)
                    const next = findNextBubble(cellIndex, dr, dc);

                    // spawn exactly one particle for this direction (if below cap)
                    if (activeCount + 1 > MAX_ACTIVE_PARTICLES) return;

                    // random rotation for each particle
                    const rot = Math.floor(Math.random() * 360);

                    // Always request 'small' size; getParticleFromPool supports (sizeVariant, rotationDeg)
                    const p = getParticleFromPool('small', rot);
                    if (!p) return;

                    // small jitter so particles don't all start in exactly the same pixel
                    const jitterX = (Math.random() - 0.5) * 8;
                    const jitterY = (Math.random() - 0.5) * 8;
                    p.style.left = (sx + jitterX) + 'px';
                    p.style.top = (sy + jitterY) + 'px';
                    p.style.opacity = '1';

                    // ensure it's in the DOM
                    if (!document.body.contains(p)) document.body.appendChild(p);

                    if (next !== null) {
                        // target exists: aim roughly at the center of the target cell
                        const targetEl = boardEl.querySelector(`[data-index='${next}']`);
                        if (targetEl) {
                            const tr = targetEl.getBoundingClientRect();
                            const tx = tr.left + tr.width / 2 + (Math.random() - 0.5) * 12;
                            const ty = tr.top + tr.height / 2 + (Math.random() - 0.5) * 12;
                            // duration tuned per direction (slightly varied)
                            const dur = 400 + Math.random() * 600 + dirIdx * 20;
                            animateParticleTo(p, sx + jitterX, sy + jitterY, tx, ty, dur, () => {
                                try {
                                    if (!hitTargets.has(next)) {
                                        hitTargets.add(next);
                                        handleClick(next, false, tracker);
                                    }
                                } catch (e) { }
                            });
                        } else {
                            // no element found, send particle off-screen based on fallback direction
                            const tx = sx + ox * (window.innerWidth * 0.8) + (Math.random() - 0.5) * 80;
                            const ty = sy + oy * (window.innerHeight * 0.8) + (Math.random() - 0.5) * 80;
                            const dur = 700 + Math.random() * 260;
                            animateParticleTo(p, sx + jitterX, sy + jitterY, tx, ty, dur, null);
                        }
                    } else {
                        // no target in that direction: send particle outwards visually
                        const tx = sx + ox * (window.innerWidth * 0.8) + (Math.random() - 0.5) * 80;
                        const ty = sy + oy * (window.innerHeight * 0.8) + (Math.random() - 0.5) * 80;
                        const dur = 700 + Math.random() * 260;
                        animateParticleTo(p, sx + jitterX, sy + jitterY, tx, ty, dur, null);
                    }
                });

            }


            function popAt(index, tracker) {
                const cellEl = boardEl.querySelector(`[data-index='${index}']`); if (!cellEl) return; try { const r0 = cellEl.getBoundingClientRect(); const gx = r0.left + r0.width / 2; const gy = r0.top + r0.height / 2; const glow = document.createElement('div'); glow.className = 'glow'; glow.style.left = gx + 'px'; glow.style.top = gy + 'px'; document.body.appendChild(glow); glow.style.animation = 'glowPop 520ms ease-out forwards'; setTimeout(() => { try { glow.remove(); } catch (e) { } }, 600); } catch (e) { } const virus = cellEl.querySelector('.virus'); if (virus) { let stain = virus.querySelector('.stain'); if (!stain) { stain = document.createElement('div'); stain.className = 'stain'; virus.appendChild(stain); } stain.classList.remove('show'); void stain.offsetWidth; stain.classList.add('show'); } emitDirectionalParticles(index, tracker);
                // record position for chain centroid (for responsive badge placement)
                // make sure we only count each index once per chain
                if (tracker) {
                    try {
                        if (!Array.isArray(tracker.positions)) tracker.positions = [];
                        // record positions for badge placement (keep duplicates too for centroid)
                        tracker.positions.push(index);
                    } catch (e) { /* ignore */ }

                    // Deduplicate pops so each index only increments the chain once
                    if (!tracker.poppedSet) tracker.poppedSet = new Set();
                    if (!tracker.poppedSet.has(index)) {
                        tracker.poppedSet.add(index);
                        tracker.pops = (tracker.pops || 0) + 1;

                        // Only award an extra click on every *odd* pop after the second one (3rd, 5th, 7th.)
                        if (tracker.pops > 2 && (tracker.pops % 2) === 1) {
                            clicksLeft = Math.min(MAX_CLICKS, clicksLeft + 1);
                            playSfx('fill');
                        }
                        const chainMultiplier = 1 + (tracker.pops - 1) * 0.5;
                        const earned = Math.round(10 * chainMultiplier * (1 + screensPassed * 0.1));
                        totalScore += earned;
                        updateHUD();
                        try { if (window.Assistant && (tracker.pops || 0) > 10) Assistant.emit && Assistant.emit('cascade', { pops: tracker.pops }); } catch (e) { }

                    }
                }

            }

            // ----- Cleaned out-of-clicks handling (previously corrupted) -----
            function checkOutOfClicks() {
                if (clicksLeft <= 0 && !outOfClicksShown) {
                    outOfClicksShown = true;
                    try { playSfx('lose'); } catch (e) { }

                    // Show persistent popup — will remain until the player clicks the existing restart button
                    showGameOverPopup({ title: 'GAME OVER', subtitle: 'click to try again', persistent: true });
                    // wait a bit longer than popup animation
                }
            }


            // ----- Badge rules & display -----
            const BADGE_RULES = [
                { min: 22, title: 'INCREDIBLE', icon: 'explosion', scoreBonus: 200, extraClicks: 3, className: 'incredible' },
                { min: 18, title: 'STUPENDOUS', icon: 'starburst', scoreBonus: 120, extraClicks: 2, className: 'stupendous' },
                { min: 14, title: 'AMAZING', icon: 'spark', scoreBonus: 70, extraClicks: 2, className: 'amazing' },
                { min: 10, title: 'GREAT', icon: 'pixel-star', scoreBonus: 30, extraClicks: 1, className: 'great' },
            ];

            function particlesActive() { try { if (PARTICLE_POOL.some(p => p && p._inUse)) return true; if (document.querySelectorAll && document.querySelectorAll('.particle.animate').length > 0) return true; } catch (e) { } return false; }

            function waitForParticlesThenShow(tracker, cb) { const check = () => { if (!particlesActive()) { try { cb(); } catch (e) { } } else { requestAnimationFrame(check); } }; requestAnimationFrame(check); }

            /* ---------- Retro 8-bit SVG icons ---------- */
            function getRetroIconSVG(name) {
                if (name === 'pixel-star') {
                    return `<svg width="36" height="28" viewBox="0 0 16 12" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges"><rect x="7" y="0" width="2" height="2" fill="#ffd166"/><rect x="7" y="2" width="2" height="2" fill="#ffb84d"/><rect x="5" y="2" width="6" height="2" fill="#ffd166"/><rect x="4" y="4" width="8" height="2" fill="#ffb84d"/><rect x="3" y="6" width="10" height="2" fill="#ffd166"/><rect x="5" y="8" width="6" height="2" fill="#ffb84d"/></svg>`;
                }
                if (name === 'spark') {
                    return `<svg width="36" height="28" viewBox="0 0 16 12" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges"><rect x="7" y="0" width="2" height="2" fill="#ffe07a"/><rect x="6" y="2" width="4" height="1" fill="#ffd166"/><rect x="4" y="3" width="8" height="1" fill="#ffd166"/><rect x="7" y="4" width="2" height="2" fill="#ffd166"/><rect x="2" y="6" width="12" height="1" fill="#ffb84d"/></svg>`;
                }
                if (name === 'starburst') {
                    return `<svg width="36" height="28" viewBox="0 0 16 12" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges"><rect x="7" y="0" width="2" height="2" fill="#fff2a6"/><rect x="6" y="2" width="4" height="1" fill="#ffd166"/><rect x="4" y="3" width="8" height="1" fill="#ffd166"/><rect x="7" y="4" width="2" height="2" fill="#ffd166"/><rect x="0" y="5" width="16" height="1" fill="#ffb84d"/><rect x="5" y="6" width="6" height="1" fill="#ffd166"/></svg>`;
                }
                if (name === 'explosion') {
                    return `<svg width="36" height="28" viewBox="0 0 16 12" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges"><rect x="7" y="0" width="2" height="2" fill="#ffdf6d"/><rect x="5" y="2" width="6" height="1" fill="#ffd166"/><rect x="3" y="3" width="10" height="1" fill="#ffb84d"/><rect x="2" y="4" width="12" height="1" fill="#ff6f3f"/><rect x="4" y="6" width="8" height="1" fill="#ffb84d"/><rect x="6" y="7" width="4" height="1" fill="#ffd166"/></svg>`;
                }
                return '';
            }

            /* ---------- CONFETTI DISABLED (kept as no-op so badges still work) ---------- */
            /* Keep a placeholder pool (harmless) */
            const CONFETTI_POOL = [];
            /* createConfettiPiece / getConfettiPiece / releaseConfettiPiece
             replaced with no-ops to avoid creating DOM nodes or animations */
            function makeConfettiPiece() {
                // intentionally disabled - confetti removed to improve performance
                const d = document.createElement('div'); d.className = 'confetti'; d._inUse = false; return d;
            }
            function getConfettiPiece() {
                // intentionally return null (or a harmless placeholder) so no pieces get animated
                return null;
            }
            function releaseConfettiPiece(p) {// no-op
            }

            /* emitConfettiAt is replaced with a safe no-op. showChainBadge still calls it,
               but nothing will be created or animated. */
            function emitConfettiAt(x, y, tier) {
                // Intentionally disabled: confetti removed.
                // If you later want to re-enable confetti, restore the original implementation.
                return;
            }


            /* ---------- showChainBadge with retro icon + confetti ---------- */

            function showChainBadge(tracker) {
                if (!tracker) return;
                // Decide badge AFTER particles settle so we use final tracker.pops
                waitForParticlesThenShow(tracker, () => {
                    try {
                        const count = tracker.pops || 0;
                        console.log('[Badge] final tracker.pops =', count);
                        const rule = BADGE_RULES.find(r => count >= r.min);
                        if (!rule) return;

                        const badge = document.createElement('div');
                        badge.className = 'chain-badge ' + rule.className;
                        const iconSVG = getRetroIconSVG(rule.icon) || '';
                        badge.innerHTML = `
                            <div class="cb-icon">${iconSVG}</div>
                            <div style="display:flex;flex-direction:column;line-height:1;">
                              <div style="font-size:14px;opacity:0.95">${rule.title}</div>
                              <div style="font-size:12px;opacity:0.85">x${count} pops</div>
                            </div>`;

                        const placeBadge = () => {
                            let cx = window.innerWidth / 2;
                            let cy = window.innerHeight * 0.12;
                            try {
                                if (Array.isArray(tracker.positions) && tracker.positions.length) {
                                    const centers = tracker.positions.map(i => {
                                        const el = boardEl.querySelector(`[data-index='${i}']`);
                                        if (!el) return null;
                                        const r = el.getBoundingClientRect();
                                        return { x: r.left + r.width / 2, y: r.top + r.height / 2 };
                                    }).filter(Boolean);
                                    if (centers.length) { cx = centers.reduce((s, p) => s + p.x, 0) / centers.length; cy = centers.reduce((s, p) => s + p.y, 0) / centers.length - 60; }
                                }
                            } catch (e) { }
                            if (cy < 60) cy = 60; if (cx < 40) cx = 40; if (cx > window.innerWidth - 40) cx = window.innerWidth - 40;
                            badge.style.left = cx + 'px'; badge.style.top = cy + 'px'; badge.style.transform = 'translateX(-50%) translateY(-6px) scale(0.85)';
                            return { cx, cy };
                        };

                        document.body.appendChild(badge);
                        const pos = placeBadge();
                        requestAnimationFrame(() => badge.classList.add('show'));
                        try { const rect = badge.getBoundingClientRect(); const cx = pos.cx || (rect.left + rect.width / 2); const cy = pos.cy || (rect.top + rect.height / 2); emitConfettiAt(cx, cy, rule.className); } catch (e) { }
                        if (rule.scoreBonus) totalScore += rule.scoreBonus;
                        if (rule.extraClicks) { clicksLeft = Math.min(MAX_CLICKS, clicksLeft + rule.extraClicks); playSfx('fill'); }
                        updateHUD();
                        setTimeout(() => { badge.classList.remove('show'); badge.classList.add('hide'); setTimeout(() => { try { badge.remove(); } catch (e) { } }, 420); }, 2100);
                    } catch (e) { console.warn('showChainBadge error', e); }
                });
            }

            // ----- Core interaction -----
            // ----- Core interaction -----
            function handleClick(index, isUser = false, tracker = null) {
                if (isUser) {
                    // block clicks if game is locked or already out of clicks
                    if (inputLocked || clicksLeft <= 0) return;

                    // lock input for the duration of this chain
                    inputLocked = true;

                    clicksLeft--;
                    updateHUD();

                    // start a tracker for this chain (add sets to deduplicate hits within the chain)
                    tracker = {
                        pops: 0,
                        positions: [],
                        finalized: false,
                        // set of indices already popped during this chain (prevents double counting)
                        poppedSet: new Set(),
                        // (optional) set used by emitters to check whether a target was already hit
                        hitSet: new Set()
                    };


                    // show badge after short delay (existing behavior)
                    setTimeout(() => {
                        if (tracker) {
                            tracker.finalized = true;
                            showChainBadge(tracker);
                        }
                    }, 2200);
                }

                // handle empty cell (no virus)
                if (state[index] === null) {
                    if (isUser) {
                        state[index] = 0;
                        scheduleRender();
                    }
                    // unlock since nothing actually happened
                    inputLocked = false;
                    // If we just consumed the last click and there are no particles, check game over now
                    // Use requestAnimationFrame so DOM updates settle first
                    requestAnimationFrame(() => {
                        if (!particlesActive() && clicksLeft <= 0) checkOutOfClicks();
                    });
                    return;
                }

                playSfx('grow');
                state[index] += 1;
                // Immediate paint so players see the size change without waiting for the RAF queue
                try { render(); } catch (e) { scheduleRender(); }


                if (state[index] <= MAX_SIZE) {
                    scheduleRender();
                    inputLocked = false;
                    // same immediate check as above
                    requestAnimationFrame(() => {
                        if (!particlesActive() && clicksLeft <= 0) checkOutOfClicks();
                    });
                    return;
                }

                // Pop event
                playSfx('pop');
                popAt(index, tracker);
                state[index] = null;
                scheduleRender();
                // single scheduled render; don't call render() directly here to avoid double-running level-complete
                scheduleRender();


                // Define common callback for after chain/particle resolution
                const afterChain = () => {
                    inputLocked = false; // allow next click
                    if (clicksLeft <= 0) checkOutOfClicks();
                };

                // If there is no tracker or no particles currently active, run callback immediately (next frame)
                try {
                    // If tracker is falsy or there are no particles to wait for, call immediately
                    if (!tracker || !particlesActive()) {
                        requestAnimationFrame(afterChain);
                    } else {
                        // Otherwise wait until particles/animations finish
                        waitForParticlesThenShow(tracker, afterChain);
                    }
                } catch (e) {
                    // In case helper functions are missing, fall back to immediate unlock + check
                    inputLocked = false;
                    if (clicksLeft <= 0) checkOutOfClicks();
                }
            }



            // Safe event wiring: check nodes exist before attaching
            if (boardEl) {
                boardEl.addEventListener('pointerdown', (ev) => { const c = ev.target.closest('.cell'); if (!c) return; const i = Number(c.dataset.index); handleClick(i, true); });
            }

            const restartBtn = document.getElementById('restart');
            if (restartBtn) { restartBtn.addEventListener('click', () => { screensPassed = 0; totalScore = 0; randomizeBoard(false); }); }

            let sfxMuted = false;
            // The mute button lives after the script in the DOM, but DOMContentLoaded guarantees it exists now
            const muteBtn = document.getElementById('mute');
            if (muteBtn) { muteBtn.addEventListener('click', () => { sfxMuted = !sfxMuted; muteBtn.textContent = sfxMuted ? 'M' : 'M'; Object.values(sfxCache).forEach(a => { try { a.muted = sfxMuted; } catch (e) { } }); if (typeof musicAudio !== 'undefined' && musicAudio) try { musicAudio.muted = sfxMuted; } catch (e) { } }); }

            // --- START BUTTON: keep SVG intact and toggle state via class instead of overwriting content ---
            function setStartBtnPlaying(isPlaying) {
                try {
                    // prefer boolean
                    isPlaying = !!isPlaying;
                    // ensure startBtn exists
                    if (!startBtn) startBtn = document.getElementById('startBtn');
                    if (!startBtn) return;
                    // Toggle a class for styling; do not change innerHTML so SVG stays
                    startBtn.classList.toggle('playing', isPlaying);
                    // Keep an accessible label
                    startBtn.setAttribute('aria-pressed', String(isPlaying));
                    startBtn.setAttribute('title', isPlaying ? 'Stop music' : 'Start music');
                } catch (e) { /* ignore */ }
            }

            // initial state: prefer to show SVG, not text
            try {
                setStartBtnPlaying(!!(typeof musicAudio !== 'undefined' && musicAudio && !musicAudio.paused));
            } catch (e) { setStartBtnPlaying(false); }

            startBtn.addEventListener('click', async () => {
                // Ensure SFX are primed (same as before)
                Object.keys(SFX_URLS).forEach(k => { try { createSfx(k); } catch (e) { } });

                // If music is playing -> stop it
                if (typeof musicAudio !== 'undefined' && musicAudio && !musicAudio.paused) {
                    try {
                        stopBackgroundMusic(); // pauses and clears musicAudio
                    } catch (e) { /* ignore */ }
                    // reflect state without overwriting button contents
                    setStartBtnPlaying(false);
                    return;
                }

                // Otherwise start music
                try {
                    startBackgroundMusic();
                    // set state to playing (a small timeout ensures musicAudio has been created if created asynchronously)
                    setTimeout(() => setStartBtnPlaying(true), 30);
                } catch (e) {
                    console.warn('startBackgroundMusic failed', e);
                    setStartBtnPlaying(false);
                }
            });


            // initialize clicks meter (10 segments) and ensure it updates with HUD
            createClicksMeter(10);
            updateClicksMeter(clicksLeft);

            randomizeBoard(false);

        }); // end DOMContentLoaded
    </script>







    <div class="particle" style="--rot: 288deg; left: 827.04px; top: 47.1607px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 269deg; left: 832.779px; top: 54.2286px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 281deg; left: 838.093px; top: 54.7104px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 87deg; left: 836.976px; top: 48.0511px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 304deg; left: 832.216px; top: 46.219px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 3deg; left: 855.73px; top: 1296.08px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 111deg; left: 816.286px; top: 1307.76px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 340deg; left: 879.097px; top: 1343.54px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 178deg; left: 860.987px; top: 1346.89px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 66deg; left: 798.253px; top: 1344.39px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 207deg; left: -1478.72px; top: 208.225px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 245deg; left: -1437.51px; top: 244.604px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 18deg; left: -1449.33px; top: 184.705px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 244deg; left: -1509.14px; top: 200.076px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 328deg; left: -1483.59px; top: 209.799px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 55deg; left: 3137.36px; top: 135.091px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 353deg; left: 3189.4px; top: 206.985px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 166deg; left: 3151.58px; top: 174.123px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 163deg; left: 3103.84px; top: 175.82px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 276deg; left: 3144.78px; top: 185.536px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 176deg; left: 835.767px; top: -1011.73px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 1deg; left: 888.996px; top: -990.248px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 238deg; left: 836.024px; top: -987.81px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 355deg; left: 808.082px; top: -1044.45px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 235deg; left: 790.956px; top: -1046.78px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 346deg; left: 830.694px; top: 1200.31px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 194deg; left: 788.882px; top: 1095.71px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 193deg; left: 808.157px; top: 1149.52px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 215deg; left: 833.683px; top: 1205.34px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 276deg; left: 864.499px; top: 1127.24px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 89deg; left: -1417.82px; top: 3.55971px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 219deg; left: -1507.94px; top: 98.5962px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 83deg; left: -1449.99px; top: 78.4637px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 158deg; left: -1410.35px; top: 91.5602px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 30deg; left: -1505.66px; top: 106.551px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 344deg; left: 3130.47px; top: 77.5284px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 349deg; left: 3149.1px; top: 71.265px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 343deg; left: 3154.65px; top: 42.1353px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 334deg; left: 3104.63px; top: 112.732px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 120deg; left: 3197.86px; top: -2.71776px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 138deg; left: 1021.68px; top: -1002.11px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 138deg; left: 1176.77px; top: 397.161px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 185deg; left: 907.508px; top: -1085.38px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 279deg; left: 1050.14px; top: 409.086px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 161deg; left: 1183.36px; top: 412.745px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 267deg; left: 920.047px; top: 1114.99px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 222deg; left: 908.379px; top: 49.9792px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 12deg; left: 903.146px; top: 51.1119px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 173deg; left: 897.081px; top: 55.6266px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 126deg; left: 901.912px; top: 46.112px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 77deg; left: 903.291px; top: 51.0592px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 217deg; left: 1181.46px; top: 63.3318px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 179deg; left: 1176.22px; top: 58.3954px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 163deg; left: 1193.28px; top: 50.0939px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 240deg; left: 963.699px; top: 1194.71px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 26deg; left: 1181.94px; top: 60.6559px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 20deg; left: 1179.44px; top: 401.719px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 36deg; left: 1193.51px; top: 409.751px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 259deg; left: 957.36px; top: 1090.28px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 247deg; left: 888.837px; top: 1190.17px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 286deg; left: 899.428px; top: 1156.98px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 230deg; left: 843.34px; top: 59.2522px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 316deg; left: 842.302px; top: 59.0977px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 168deg; left: 841.613px; top: 47.1412px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 257deg; left: 828.49px; top: 56.8766px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 21deg; left: 834.523px; top: 63.6221px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 158deg; left: 1193.13px; top: 63.2235px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 249deg; left: 1177.19px; top: 50.8474px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 200deg; left: 1193.91px; top: 53.7047px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 128deg; left: 1176.08px; top: 46.6826px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="confetti" style="background: rgb(255, 138, 77); left: 987.727px; top: 179.545px; --sx: 0px; --sy: 0px; --tx: 109.48368776928565px; --ty: -9.288933281121935px; opacity: 0; transform: translate(-50%, -50%) scale(1);"></div><div class="confetti" style="background: rgb(255, 184, 77); left: 987.727px; top: 179.545px; --sx: 0px; --sy: 0px; --tx: -9.40730286205215px; --ty: -98.56647023827949px; opacity: 0; transform: translate(-50%, -50%) scale(1);"></div><div class="confetti" style="background: rgb(255, 224, 122); left: 987.727px; top: 179.545px; --sx: 0px; --sy: 0px; --tx: -70.21141612739748px; --ty: -101.97096688992497px; opacity: 0; transform: translate(-50%, -50%) scale(1);"></div><div class="confetti" style="background: rgb(255, 209, 102); left: 987.727px; top: 179.545px; --sx: 0px; --sy: 0px; --tx: -11.2675674341573px; --ty: -104.87350893411943px; opacity: 0; transform: translate(-50%, -50%) scale(1);"></div><div class="confetti" style="background: rgb(255, 184, 77); left: 987.727px; top: 179.545px; --sx: 0px; --sy: 0px; --tx: -82.48935106897672px; --ty: -107.82177589818342px; opacity: 0; transform: translate(-50%, -50%) scale(1);"></div><div class="confetti" style="background: rgb(255, 184, 77); left: 987.727px; top: 179.545px; --sx: 0px; --sy: 0px; --tx: 115.0492635946823px; --ty: -56.178653845242636px; opacity: 0; transform: translate(-50%, -50%) scale(1);"></div><div class="particle small" style="--rot: 53deg; left: 1190.19px; top: 62.5394px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 165deg; left: 1187.96px; top: 262.479px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 1deg; left: 1176.49px; top: 273.617px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 113deg; left: 1191.89px; top: 256.698px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 261deg; left: 1181.96px; top: 258.043px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 344deg; left: 1051.04px; top: 398.334px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 31deg; left: 1038.89px; top: 399.33px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 116deg; left: 1046.56px; top: 397.821px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 200deg; left: 1049.8px; top: 401.957px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 342deg; left: -1278.11px; top: 380.637px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 57deg; left: -1275.77px; top: 277.865px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 335deg; left: -1215.6px; top: 304.468px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 334deg; left: -1285.08px; top: 311.498px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 85deg; left: -1274.75px; top: 293.406px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 177deg; left: 1118.75px; top: 335.852px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 314deg; left: 1112.66px; top: 337.669px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 249deg; left: 1115.66px; top: 332.108px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 339deg; left: 1120.42px; top: 341.011px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 237deg; left: 1115.28px; top: 340.937px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 106deg; left: 1039.89px; top: 411.014px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 166deg; left: 1037.91px; top: 410.36px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 299deg; left: 1040.49px; top: 401.367px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 299deg; left: 1047.52px; top: 407.454px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 45deg; left: 909.282px; top: 132.596px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 28deg; left: 910.01px; top: 118.446px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 163deg; left: 902.146px; top: 117.96px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 342deg; left: 913.881px; top: 128.99px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 302deg; left: 913.748px; top: 118.328px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 263deg; left: 3402.8px; top: 160.932px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 143deg; left: 3329px; top: 110.927px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 118deg; left: 3395.13px; top: 122.575px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="confetti" style="background: rgb(255, 111, 63); left: 1010px; top: 161.25px; --sx: 0px; --sy: 0px; --tx: 43.483811310799766px; --ty: 4.191365416509001px; opacity: 0; transform: translate(-50%, -50%) scale(1);"></div><div class="confetti" style="background: rgb(255, 184, 77); left: 1010px; top: 161.25px; --sx: 0px; --sy: 0px; --tx: 101.42145338168777px; --ty: -109.88144764334464px; opacity: 0; transform: translate(-50%, -50%) scale(1);"></div><div class="particle" style="--rot: 218deg; left: 3404.22px; top: 118.843px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 116deg; left: 3351.67px; top: 74.9071px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 39deg; left: 883.094px; top: 1341.07px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 225deg; left: 828.226px; top: 1374.91px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 7deg; left: 841.073px; top: 1410.54px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 147deg; left: 852.762px; top: 1408.94px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 237deg; left: -1503.05px; top: 294.868px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 70deg; left: -1459.36px; top: 268.291px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 182deg; left: -1430.37px; top: 308.913px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 179deg; left: -1511.85px; top: 228.706px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 267deg; left: -1498.14px; top: 314.708px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle" style="--rot: 66deg; left: 1183.54px; top: 264.538px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 177deg; left: 1191.51px; top: 256.566px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 153deg; left: 1184.62px; top: 270.511px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle large" style="--rot: 32deg; left: 1193.15px; top: 270.166px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div><div class="particle small" style="--rot: 163deg; left: 1176.75px; top: 265.035px; opacity: 0;"><svg viewBox="0 0 100 100"><path class="antibody-arm" d="M50 28 L50 60" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L28 14" stroke-linecap="round" stroke-linejoin="round"></path><path class="antibody-arm" d="M50 36 L72 14" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="28" cy="14" r="6" class="antibody-arm"></circle><circle cx="72" cy="14" r="6" class="antibody-arm"></circle><circle cx="50" cy="28" r="5" class="antibody-arm"></circle></svg></div>
    <script>
        // Update the small high-score HUD element from localStorage
        function updateHighScoreHUD() {
            try {
                const el = document.getElementById('highScoreValue');
                if (!el) return;
                // getHighScore() should exist from the high-score helpers (if present)
                var hs = 0;
                if (typeof getHighScore === 'function') {
                    hs = getHighScore();
                } else {
                    try { hs = Number(localStorage.getItem('goneviral_highscore_v1') || localStorage.getItem('mygame_highscore_v1') || 0); } catch (e) { hs = 0; }
                }
                el.textContent = Number(hs || 0).toLocaleString();
            } catch (e) {
                console.warn('updateHighScoreHUD error', e);
            }
        }

        // Call once on DOM ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', updateHighScoreHUD);
        } else {
            updateHighScoreHUD();
        }

        // Optional: expose for console
        window.updateHighScoreHUD = updateHighScoreHUD;
    </script>


    <script>
        // Robust cleanup for any persistent game-over popups.
        //
        // This removes all elements with class 'game-over-popup' by playing the same hide animation
        // and removing them on animationend. It also clears the outOfClicksShown guard so future
        // game-overs may appear normally.
        //
        // A single restart-button listener is wired (idempotent) to call this on click.
        (function () {
            function cleanupGameOverPopups() {
                try {
                    var nodes = document.querySelectorAll('.game-over-popup');
                    nodes.forEach(function (el) {
                        try {
                            el.classList.remove('show');
                            el.classList.add('hide');
                            // remove after hide animation (if any); fallback to immediate removal after 420ms
                            var removed = false;
                            var onEnd = function () {
                                if (removed) return;
                                removed = true;
                                try { el.remove(); } catch (e) { }
                            };
                            el.addEventListener('animationend', onEnd, { once: true });
                            // fallback timeout in case animationend doesn't fire
                            setTimeout(onEnd, 600);
                        } catch (e) { }
                    });
                } catch (e) { }
                try { outOfClicksShown = false; } catch (e) { }
            }

            // Wire restart button once to cleanup any popups when clicked.
            function wireRestartCleanup() {
                try {
                    var restartBtn = document.getElementById('restart');
                    if (!restartBtn) return;
                    if (restartBtn._gop_cleanup_wired) return;
                    restartBtn._gop_cleanup_wired = true;
                    restartBtn.addEventListener('click', function () {
                        cleanupGameOverPopups();
                    });
                } catch (e) { }
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', wireRestartCleanup);
            } else {
                wireRestartCleanup();
            }

            // Expose for debugging
            window.cleanupGameOverPopups = cleanupGameOverPopups;
        })();
    </script>


    <!-- High-score debug & control injection -->
    <script>
        (function () {
            try {
                window.HIGH_SCORE_KEY = window.HIGH_SCORE_KEY || 'goneViral_highScore';

                window.loadHighScore = function () {
                    try {
                        var raw = localStorage.getItem(window.HIGH_SCORE_KEY);
                        window.highScore = Number(raw || 0);
                        console.log('[GoneViral] loadHighScore ->', raw, 'parsed:', window.highScore);
                    } catch (e) {
                        console.warn('[GoneViral] loadHighScore failed', e);
                        window.highScore = window.highScore || 0;
                    }
                    try {
                        var el = document.getElementById('highScoreValue');
                        if (el) el.textContent = String(window.highScore);
                    } catch (e) { }
                    return window.highScore;
                };

                window.saveHighScore = function () {
                    try {
                        var val = Number(window.highScore || 0);
                        localStorage.setItem(window.HIGH_SCORE_KEY, String(val));
                        console.log('[GoneViral] saveHighScore ->', val);
                    } catch (e) {
                        console.warn('[GoneViral] saveHighScore failed', e);
                    }
                };

                // Call load on DOM ready
                document.addEventListener('DOMContentLoaded', function () {
                    try { window.loadHighScore(); } catch (e) { console.warn(e); }


                    // Wrap updateHUD to persist highs if not already saving
                    try {
                        if (typeof window.updateHUD === 'function') {
                            var orig = window.updateHUD;
                            window.updateHUD = function () {
                                try { orig.apply(this, arguments); } catch (e) { console.warn('orig updateHUD failed', e); }
                                try {
                                    // determine saved value
                                    var saved = Number(localStorage.getItem(window.HIGH_SCORE_KEY) || 0);
                                    var current = (typeof totalScore !== 'undefined') ? Number(totalScore) : (typeof window.totalScore !== 'undefined' ? Number(window.totalScore) : null);
                                    if (current !== null && current > saved) {
                                        window.highScore = current;
                                        try { window.saveHighScore(); } catch (e) { console.warn(e); }
                                        var el = document.getElementById('highScoreValue');
                                        if (el) el.textContent = String(window.highScore);
                                        console.log('[GoneViral] updateHUD persisted high ->', window.highScore);
                                    }
                                } catch (e) { console.warn('updateHUD wrapper error', e); }
                            };
                            console.log('[GoneViral] updateHUD wrapped to persist highs');
                        } else {
                            console.log('[GoneViral] updateHUD not found to wrap');
                        }
                    } catch (e) { console.warn(e); }


                    /* AUDIO CONTROLS INTEGRATION - v2
                       This code runs inside the existing DOMContentLoaded closure so it can access local vars
                       like musicAudio, createSfx, sfxCache, playNextMusicTrack, etc., if they exist locally.
                    */
                    (function () {
                        // prefer using local variables if available, otherwise fall back to window-level
                        function getMusicAudio() { try { return (typeof musicAudio !== 'undefined') ? musicAudio : window.musicAudio; } catch (e) { return window.musicAudio; } }
                        function setMusicAudioProps() {
                            try {
                                const ma = getMusicAudio();
                                if (ma) {
                                    ma.volume = (typeof musicVolume !== 'undefined') ? musicVolume : (window.musicVolume || ma.volume || 0.2);
                                    ma.muted = !!(typeof allMuted !== 'undefined' ? allMuted : window.allMuted);
                                }
                            } catch (e) { }
                        }

                        // ensure window-level state exists so UI handlers can update reliably
                        window.musicVolume = (typeof musicVolume !== 'undefined') ? musicVolume : (window.musicVolume || 0.20);
                        window.sfxVolume = (typeof sfxVolume !== 'undefined') ? sfxVolume : (window.sfxVolume || 0.50);
                        window.allMuted = (typeof allMuted !== 'undefined') ? allMuted : (window.allMuted || false);

                        // if local variables exist, keep them in sync via simple helpers
                        function syncLocalFromWindow() {
                            try {
                                if (typeof musicVolume !== 'undefined') musicVolume = window.musicVolume;
                                else window.musicVolume = window.musicVolume;
                            } catch (e) { }
                            try {
                                if (typeof sfxVolume !== 'undefined') sfxVolume = window.sfxVolume;
                                else window.sfxVolume = window.sfxVolume;
                            } catch (e) { }
                            try {
                                if (typeof allMuted !== 'undefined') allMuted = window.allMuted;
                                else window.allMuted = window.allMuted;
                            } catch (e) { }
                        }

                        // Patch createSfx if it exists locally in this closure
                        try {
                            if (typeof createSfx === 'function') {
                                const origCreateSfx = createSfx;
                                createSfx = function (key) {
                                    const a = origCreateSfx(key);
                                    try {
                                        if (a) {
                                            // both local and window sfxVolume considered
                                            const vol = (typeof sfxVolume !== 'undefined') ? sfxVolume : (window.sfxVolume || 0.5);
                                            a.volume = Number(vol);
                                            a.muted = !!(typeof allMuted !== 'undefined' ? allMuted : window.allMuted);
                                            // put into sfxCache if available
                                            try { if (typeof sfxCache !== 'undefined' && sfxCache) sfxCache[key] = a; } catch (e) { }
                                        }
                                    } catch (e) { }
                                    return a;
                                };
                            }
                        } catch (e) { }

                        // Patch playNextMusicTrack if present (so when musicAudio is recreated we set volumes)
                        try {
                            if (typeof playNextMusicTrack === 'function') {
                                const origPlayNext = playNextMusicTrack;
                                playNextMusicTrack = function () {
                                    const res = origPlayNext.apply(this, arguments);
                                    // small timeout to let musicAudio be set by original code
                                    setTimeout(setMusicAudioProps, 30);
                                    return res;
                                };
                            }
                        } catch (e) { }

                        // Monkeypatch Audio constructor to set default volumes on any newly created Audio objects
                        try {
                            (function () {
                                const RealAudio = window.Audio;
                                function PatchedAudio(src) {
                                    const inst = new RealAudio(src);
                                    try {
                                        const vol = (typeof sfxVolume !== 'undefined') ? sfxVolume : (window.sfxVolume || inst.volume || 0.5);
                                        inst.volume = Number(vol);
                                        inst.muted = !!(typeof allMuted !== 'undefined' ? allMuted : window.allMuted);
                                    } catch (e) { }
                                    return inst;
                                }
                                // preserve prototype so instanceof checks still work
                                PatchedAudio.prototype = RealAudio.prototype;
                                window.Audio = PatchedAudio;
                            })();
                        } catch (e) { }

                        // helper to update existing sfx cache objects
                        function updateAllSfxVolumes_local() {
                            try {
                                const cache = (typeof sfxCache !== 'undefined') ? sfxCache : window.sfxCache;
                                if (cache) {
                                    Object.values(cache).forEach(a => {
                                        try {
                                            if (!a) return;
                                            const vol = (typeof sfxVolume !== 'undefined') ? sfxVolume : (window.sfxVolume || a.volume || 0.5);
                                            a.volume = Number(vol);
                                            a.muted = !!(typeof allMuted !== 'undefined' ? allMuted : window.allMuted);
                                        } catch (e) { }
                                    });
                                }
                            } catch (e) { }
                        }

                        // UI wiring (elements already present in DOM)
                        const audioBtn = document.getElementById('audioBtn');
                        const audioPopup = document.getElementById('audioPopup');
                        const audioClose = document.getElementById('audioClose');
                        const musicSlider = document.getElementById('musicVol');
                        const sfxSlider = document.getElementById('sfxVol');
                        const musicVal = document.getElementById('musicVolVal');
                        const sfxVal = document.getElementById('sfxVolVal');
                        const popupMute = document.getElementById('popupMute');

                        function showAudioPopup() {
                            if (!audioPopup) return;
                            // sync values from current runtime (prefer local, then window)
                            const mv = (typeof musicVolume !== 'undefined') ? musicVolume : (window.musicVolume || 0.2);
                            const sv = (typeof sfxVolume !== 'undefined') ? sfxVolume : (window.sfxVolume || 0.5);
                            const am = (typeof allMuted !== 'undefined') ? allMuted : window.allMuted;
                            if (musicSlider) musicSlider.value = String(mv);
                            if (sfxSlider) sfxSlider.value = String(sv);
                            if (musicVal) musicVal.textContent = Math.round((mv * 100)) + '%';
                            if (sfxVal) sfxVal.textContent = Math.round((sv * 100)) + '%';
                            if (popupMute) {
                                popupMute.textContent = am ? 'Unmute' : 'Mute';
                                popupMute.setAttribute('aria-pressed', String(!!am));
                            }
                            audioPopup.classList.add('show');
                            audioPopup.setAttribute('aria-hidden', 'false');
                        }

                        function hideAudioPopup() {
                            if (!audioPopup) return;
                            audioPopup.classList.remove('show');
                            audioPopup.setAttribute('aria-hidden', 'true');
                        }

                        if (audioBtn) audioBtn.addEventListener('click', (e) => { showAudioPopup(); });

                        if (audioClose) {
                            audioClose.addEventListener('click', (e) => { hideAudioPopup(); });
                            // style audioClose as small ctrl too (if not already)
                            try { audioClose.classList.add('ctrl', 'small-ctrl'); } catch (e) { }
                        }

                        if (musicSlider) musicSlider.addEventListener('input', (e) => {
                            const val = Number(e.target.value);
                            // update both local and window state
                            try { if (typeof musicVolume !== 'undefined') musicVolume = val; } catch (e) { }
                            window.musicVolume = val;
                            if (musicVal) musicVal.textContent = Math.round(val * 100) + '%';
                            // apply to current musicAudio if present
                            try {
                                if (typeof musicAudio !== 'undefined' && musicAudio) {
                                    musicAudio.volume = val;
                                } else if (window.musicAudio) {
                                    window.musicAudio.volume = val;
                                }
                            } catch (e) { }
                        });

                        if (sfxSlider) sfxSlider.addEventListener('input', (e) => {
                            const val = Number(e.target.value);
                            try { if (typeof sfxVolume !== 'undefined') sfxVolume = val; } catch (e) { }
                            window.sfxVolume = val;
                            if (sfxVal) sfxVal.textContent = Math.round(val * 100) + '%';
                            updateAllSfxVolumes_local();
                        });

                        if (popupMute) popupMute.addEventListener('click', () => {
                            const newMuted = !((typeof allMuted !== 'undefined') ? allMuted : window.allMuted);
                            try { if (typeof allMuted !== 'undefined') allMuted = newMuted; } catch (e) { }
                            window.allMuted = newMuted;
                            // update UI text
                            popupMute.textContent = newMuted ? 'Unmute' : 'Mute';
                            popupMute.setAttribute('aria-pressed', String(!!newMuted));
                            // apply to music and sfx
                            try {
                                const ma = getMusicAudio();
                                if (ma) ma.muted = !!newMuted;
                            } catch (e) { }
                            updateAllSfxVolumes_local();
                        });

                        // initial apply once to any existing audio
                        try {
                            syncLocalFromWindow();
                            setMusicAudioProps();
                            updateAllSfxVolumes_local();
                        } catch (e) { }
                    })();
                });
            } catch (e) { console.error('High-score injection failed', e); }
        })();
    </script>


    <!-- AUDIO SETTINGS POPUP INSERTED BY CHATGPT -->
    <div id="audioPopup" class="audio-popup" role="dialog" aria-modal="true" aria-hidden="true" style="pointer-events:auto;">
        <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:8px;">
            <div style="display:flex; gap:8px; align-items:center;">
                <div style="width:36px;height:28px;border-radius:6px;background:rgba(0,0,0,0.12);display:flex;align-items:center;justify-content:center;">
                    <!-- tiny pixel gear svg -->
                    <svg class="gear-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path fill="currentColor" d="M20 12c0-.568-.06-1.122-.174-1.656l1.834-1.612-2-3.464-2.322.786c-.82-.736-1.787-1.308-2.86-1.657L14 2h-4l-.48 2.396c-1.07.35-2.04.92-2.858 1.657L4.34 5.268l-2 3.464 1.834 1.612C4.06 10.878 4 11.432 4 12s.06 1.122.174 1.656L2.34 15.268l2 3.464 2.322-.786c.82.736 1.787 1.308 2.86 1.657L10 22h4l.48-2.396c1.07-.35 2.038-.92 2.858-1.657l2.322.786 2-3.464-1.834-1.613c.113-.535.174-1.09.174-1.657zm-8 4c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z" />
                    </svg>
                </div>
                <div style="font-size:13px;color:#ffd166;">Audio Settings</div>
            </div>
            <button id="audioClose" class="btn" aria-label="Close audio settings">❌</button>
        </div>

        <div class="row">
            <label for="musicVol">Music Volume</label>
            <input id="musicVol" type="range" min="0" max="1" step="0.01" value="0.20" />
            <div id="musicVolVal" style="width:40px;text-align:right;font-size:11px;color:#ffe9b0;">20%</div>
        </div>

        <div class="row">
            <label for="sfxVol">SFX Volume</label>
            <input id="sfxVol" type="range" min="0" max="1" step="0.01" value="0.50" />
            <div id="sfxVolVal" style="width:40px;text-align:right;font-size:11px;color:#ffe9b0;">50%</div>
        </div>

        <div style="display:flex;gap:12px;align-items:center;justify-content:space-between;margin-top:8px;">
        </div>
    </div>
    <!-- END AUDIO SETTINGS POPUP -->
    <!-- AUDIO SETTINGS SCRIPT INSERTED BY CHATGPT -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Audio control state (tied to UI)
            window.musicVolume = window.musicVolume || 0.20;
            window.sfxVolume = window.sfxVolume || 0.50;
            window.allMuted = window.allMuted || false;

            // helper to update all sfx in sfxCache if present
            function updateAllSfxVolumes() {
                try {
                    if (window.sfxCache && typeof window.sfxCache === 'object') {
                        Object.values(window.sfxCache).forEach(a => {
                            if (!a) return;
                            try {
                                a.volume = Number(window.sfxVolume) || 0;
                                a.muted = !!window.allMuted;
                            } catch (e) { }
                        });
                    }
                } catch (e) { }
            }

            // patch createSfx if present
            if (typeof window.createSfx === 'function') {
                const origCreate = window.createSfx;
                window.createSfx = function (key) {
                    const a = origCreate(key);
                    try {
                        if (a) {
                            a.volume = Number(window.sfxVolume) || a.volume || 0.5;
                            a.muted = !!window.allMuted;
                            if (!window.sfxCache) window.sfxCache = window.sfxCache || {};
                            window.sfxCache[key] = a;
                        }
                    } catch (e) { }
                    return a;
                };
            } else {
                // define a safe fallback createSfx if game doesn't have one
                window.createSfx = window.createSfx || function (key) {
                    return null;
                };
            }

            // patch playNextMusicTrack if it exists to set volume/muted on new musicAudio
            if (typeof window.playNextMusicTrack === 'function') {
                const origPlayNext = window.playNextMusicTrack;
                window.playNextMusicTrack = function () {
                    const res = origPlayNext.apply(this, arguments);
                    try {
                        if (window.musicAudio) {
                            window.musicAudio.volume = Number(window.musicVolume) || window.musicAudio.volume || 0.2;
                            window.musicAudio.muted = !!window.allMuted;
                        }
                    } catch (e) { }
                    return res;
                };
            }

            // UI wiring for popup
            const audioBtn = document.getElementById('audioBtn');
            const audioPopup = document.getElementById('audioPopup');
            const audioClose = document.getElementById('audioClose');
            const musicSlider = document.getElementById('musicVol');
            const sfxSlider = document.getElementById('sfxVol');
            const musicVal = document.getElementById('musicVolVal');
            const sfxVal = document.getElementById('sfxVolVal');
            const popupMute = document.getElementById('popupMute');

            function showAudioPopup() {
                if (!audioPopup) return;
                musicSlider.value = String(window.musicVolume ?? 0.2);
                sfxSlider.value = String(window.sfxVolume ?? 0.5);
                musicVal.textContent = Math.round((musicSlider.value * 100)) + '%';
                sfxVal.textContent = Math.round((sfxSlider.value * 100)) + '%';
                popupMute.textContent = window.allMuted ? 'Unmute' : 'Mute';
                popupMute.setAttribute('aria-pressed', String(!!window.allMuted));
                audioPopup.classList.add('show');
                audioPopup.setAttribute('aria-hidden', 'false');
            }

            function hideAudioPopup() {
                if (!audioPopup) return;
                audioPopup.classList.remove('show');
                audioPopup.setAttribute('aria-hidden', 'true');
            }

            if (audioBtn) audioBtn.addEventListener('click', (e) => { showAudioPopup(); });
            if (audioClose) audioClose.addEventListener('click', (e) => { hideAudioPopup(); });

            if (musicSlider) musicSlider.addEventListener('input', (e) => {
                window.musicVolume = Number(e.target.value);
                if (musicVal) musicVal.textContent = Math.round(window.musicVolume * 100) + '%';
                try { if (window.musicAudio) window.musicAudio.volume = window.musicVolume; } catch (e) { }
            });

            if (sfxSlider) sfxSlider.addEventListener('input', (e) => {
                window.sfxVolume = Number(e.target.value);
                if (sfxVal) sfxVal.textContent = Math.round(window.sfxVolume * 100) + '%';
                updateAllSfxVolumes();
            });

            if (popupMute) popupMute.addEventListener('click', () => {
                window.allMuted = !window.allMuted;
                popupMute.textContent = window.allMuted ? 'Unmute' : 'Mute';
                popupMute.setAttribute('aria-pressed', String(!!window.allMuted));
                try { if (window.musicAudio) window.musicAudio.muted = !!window.allMuted; } catch (e) { }
                updateAllSfxVolumes();
            });

            // apply initial volume settings to any pre-existing audio objects
            try {
                if (window.musicAudio) {
                    window.musicAudio.volume = Number(window.musicVolume) || window.musicAudio.volume || 0.2;
                    window.musicAudio.muted = !!window.allMuted;
                }
            } catch (e) { }
            updateAllSfxVolumes();
        });
    </script>
    <!-- END AUDIO SETTINGS SCRIPT -->
    <!-- AUDIO CONTROLS ENFORCER v3 - robust global hooks -->
    <script>
        (function () {
            // defaults
            window.musicVolume = (typeof window.musicVolume === 'number') ? window.musicVolume : 0.20;
            window.sfxVolume = (typeof window.sfxVolume === 'number') ? window.sfxVolume : 0.50;
            window.allMuted = (typeof window.allMuted === 'boolean') ? window.allMuted : false;

            // Helper to apply volumes to one audio element
            function applyVolumesToElement(a) {
                try {
                    if (!a) return;
                    // Determine if element is music: prefer loop flag, otherwise use duration heuristic (>8s)
                    var isMusic = !!a.loop;
                    // If duration known and >8s treat as music
                    try {
                        if (!isMusic && a.duration && !isNaN(a.duration) && a.duration > 8) isMusic = true;
                    } catch (e) { }
                    var vol = isMusic ? window.musicVolume : window.sfxVolume;
                    // Apply
                    if (typeof vol === 'number') a.volume = Number(vol);
                    a.muted = !!window.allMuted;
                } catch (e) { }
            }

            // Apply to all existing <audio> elements
            function applyToAllExisting() {
                try {
                    var audios = document.getElementsByTagName('audio');
                    for (var i = 0; i < audios.length; i++) applyVolumesToElement(audios[i]);
                } catch (e) { }
                // also attempt to apply to any cached sfxCache if present
                try {
                    var cache = window.sfxCache || {};
                    Object.values(cache).forEach(function (a) { applyVolumesToElement(a); });
                } catch (e) { }
            }

            // Observe additions of audio elements to DOM (in case game inserts them)
            try {
                var mo = new MutationObserver(function (muts) {
                    muts.forEach(function (m) {
                        if (m.addedNodes && m.addedNodes.length) {
                            m.addedNodes.forEach(function (n) {
                                try {
                                    if (n && n.tagName && n.tagName.toLowerCase() === 'audio') {
                                        // small timeout for attributes to settle
                                        setTimeout(function () { applyVolumesToElement(n); }, 10);
                                    } else if (n && n.querySelectorAll) {
                                        var found = n.querySelectorAll('audio');
                                        for (var i = 0; i < found.length; i++) setTimeout((function (el) { return function () { applyVolumesToElement(el); }; })(found[i]), 10);
                                    }
                                } catch (e) { }
                            });
                        }
                    });
                });
                mo.observe(document.documentElement || document.body, { childList: true, subtree: true });
            } catch (e) { }

            // Monkeypatch Audio constructor so new instances get correct volume/muted and have play patched
            try {
                var NativeAudio = window.Audio;
                if (NativeAudio) {
                    function WrappedAudio(src) {
                        var inst = new NativeAudio(src);
                        try {
                            // attempt to set volume based on whether loop is set (if loop may be set later)
                            // We'll patch play to re-evaluate before playing.
                            inst.muted = !!window.allMuted;
                            // no immediate volume set here (could be SFX or music); set in play()
                        } catch (e) { }
                        return inst;
                    }
                    WrappedAudio.prototype = NativeAudio.prototype;
                    window.Audio = WrappedAudio;
                }
            } catch (e) { }

            // Patch HTMLMediaElement.prototype.play to set volumes just-in-time
            try {
                var proto = HTMLMediaElement && HTMLMediaElement.prototype;
                if (proto && !proto.__volumePatchedByChatGPT_v3) {
                    var origPlay = proto.play;
                    proto.play = function () {
                        try {
                            // Determine music vs sfx: loop flag high priority; else heuristic by duration or src filename containing 'music' or 'bg'
                            var el = this;
                            var isMusic = !!el.loop;
                            try {
                                if (!isMusic && el.duration && !isNaN(el.duration) && el.duration > 8) isMusic = true;
                            } catch (e) { }
                            try {
                                if (!isMusic && el.src && (el.src.match(/music|bgm|_music|background/i))) isMusic = true;
                            } catch (e) { }
                            var vol = isMusic ? window.musicVolume : window.sfxVolume;
                            if (typeof vol === 'number') el.volume = Number(vol);
                            el.muted = !!window.allMuted;
                        } catch (e) { }
                        return origPlay.apply(this, arguments);
                    };
                    proto.__volumePatchedByChatGPT_v3 = true;
                }
            } catch (e) { }

            // UI wiring: sliders and mute button
            function setupUIHandlers() {
                try {
                    var musicSlider = document.getElementById('musicVol');
                    var sfxSlider = document.getElementById('sfxVol');
                    var musicVal = document.getElementById('musicVolVal');
                    var sfxVal = document.getElementById('sfxVolVal');
                    var popupMute = document.getElementById('popupMute');
                    var audioClose = document.getElementById('audioClose');

                    if (musicSlider) {
                        musicSlider.value = String(window.musicVolume || 0.2);
                        musicVal && (musicVal.textContent = Math.round((window.musicVolume || 0.2) * 100) + '%');
                        musicSlider.addEventListener('input', function (e) {
                            window.musicVolume = Number(e.target.value);
                            musicVal && (musicVal.textContent = Math.round(window.musicVolume * 100) + '%');
                            // apply to any existing audio elements that look like music
                            try {
                                var aud = document.getElementsByTagName('audio');
                                for (var i = 0; i < aud.length; i++) {
                                    var a = aud[i];
                                    if (a.loop || (a.duration && !isNaN(a.duration) && a.duration > 8) || (a.src && a.src.match(/music|bgm|_music|background/i))) {
                                        a.volume = window.musicVolume;
                                    }
                                }
                                // also set on window.musicAudio if exists
                                if (window.musicAudio) try { window.musicAudio.volume = window.musicVolume; } catch (e) { }
                            } catch (e) { }
                        });
                    }
                    if (sfxSlider) {
                        sfxSlider.value = String(window.sfxVolume || 0.5);
                        sfxVal && (sfxVal.textContent = Math.round((window.sfxVolume || 0.5) * 100) + '%');
                        sfxSlider.addEventListener('input', function (e) {
                            window.sfxVolume = Number(e.target.value);
                            sfxVal && (sfxVal.textContent = Math.round(window.sfxVolume * 100) + '%');
                            // apply to short audio elements
                            try {
                                var aud = document.getElementsByTagName('audio');
                                for (var i = 0; i < aud.length; i++) {
                                    var a = aud[i];
                                    if (!a.loop && (!(a.duration && !isNaN(a.duration) && a.duration > 8)) && !(a.src && a.src.match(/music|bgm|_music|background/i))) {
                                        a.volume = window.sfxVolume;
                                    }
                                }
                                // apply to sfxCache if any
                                if (window.sfxCache) {
                                    Object.values(window.sfxCache).forEach(function (a) { try { if (a) a.volume = window.sfxVolume; } catch (e) { } });
                                }
                            } catch (e) { }
                        });
                    }
                    if (popupMute) {
                        // ensure styled like other HUD buttons - class already changed earlier, but enforce
                        try { popupMute.classList.add('ctrl', 'small-ctrl'); } catch (e) { }
                        popupMute.addEventListener('click', function () {
                            window.allMuted = !window.allMuted;
                            popupMute.setAttribute('aria-pressed', String(!!window.allMuted));
                            popupMute.textContent = window.allMuted ? 'Unmute' : 'Mute';
                            // apply to all
                            try {
                                var aud = document.getElementsByTagName('audio');
                                for (var i = 0; i < aud.length; i++) { try { aud[i].muted = !!window.allMuted; } catch (e) { } }
                                if (window.musicAudio) try { window.musicAudio.muted = !!window.allMuted; } catch (e) { }
                                if (window.sfxCache) Object.values(window.sfxCache).forEach(function (a) { try { if (a) a.muted = !!window.allMuted; } catch (e) { } });
                            } catch (e) { }
                        });
                    }
                    if (audioClose) {
                        try { audioClose.classList.add('ctrl', 'small-ctrl'); } catch (e) { }
                    }
                } catch (e) { }
            }

            // Run setup now and also once DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function () { setupUIHandlers(); applyToAllExisting(); });
            } else {
                setupUIHandlers();
                applyToAllExisting();
            }

            // Expose a manual apply function for troubleshooting
            window.__applyAudioControlsNow = function () { applyToAllExisting(); };

        })();
    </script>
    <!-- END AUDIO CONTROLS ENFORCER v3 -->
    <!-- HOW TO PLAY POPUP -->
    <div id="helpPopup" class="audio-popup" role="dialog" aria-modal="true" aria-hidden="true" style="pointer-events:auto;">
        <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:8px;">
            <div style="display:flex; gap:8px; align-items:center;">
                <div style="width:36px;height:28px;border-radius:6px;background:rgba(0,0,0,0.12);display:flex;align-items:center;justify-content:center;">
                    <!-- question mark icon -->
                    <svg class="gear-icon" viewBox="0 0 7 10" xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px;">
                        <path fill="currentColor" d="M2 3C2 3.5523 1.5523 4 1 4C0.44772 4 0 3.5523 0 3C0 1.44772 1.4477 0 3 0C4.5523 0 6 1.44772 6 3C6 4.285 5.5004 4.8678 4.4472 5.3944C4.0004 5.6178 4 5.6183 4 6C4 6.5523 3.5523 7 3 7C2.4477 7 2 6.5523 2 6C2 4.715 2.4996 4.1322 3.5528 3.6056C3.9996 3.3822 4 3.3817 4 3C4 2.55228 3.4477 2 3 2C2.5523 2 2 2.55228 2 3zM3 10C2.4477 10 2 9.5523 2 9C2 8.4477 2.4477 8 3 8C3.5523 8 4 8.4477 4 9C4 9.5523 3.5523 10 3 10z" />
                    </svg>
                </div>
                <div style="font-size:13px;color:#ffd166;">How to Play</div>
            </div>
            <button id="helpClose" class="ctrl small-ctrl" aria-label="Close help">❌</button>
        </div>

        <ul style="margin:6px 0 0 6px; color:#ffe9b0; font-size:10px; line-height:1.4;">
            Welcome to Pandemonium Biotech. Our cutting-edge nanobot program was designed to eliminate viral threats before they reach the outside world.
            Unfortunately, something has gone horribly wrong. Containment protocols have failed, and the lab is overrun with rogue pathogens.
            Deploy your nanobots and eradicate every last microbe before Pandemonium Biotech lives up to its name.
            <br />
            <br />
            <li>You start with 10 nano-bots.</li>
            <li>Use them by clicking on pathogens to make them grow and burst.</li>
            <li>Bursting pathogens can create cascades and earn you additional nano-bots.</li>
            <li>If you run out of nano-bots, it's game over.</li>
        </ul>
    </div>
    <!-- END HOW TO PLAY POPUP -->


    <script>
        document.addEventListener('DOMContentLoaded', function () {
            try {
                const helpBtn = document.getElementById('helpBtn');
                const helpPopup = document.getElementById('helpPopup');
                const helpClose = document.getElementById('helpClose');

                function showHelp() {
                    if (!helpPopup) return;
                    helpPopup.classList.add('show');
                    helpPopup.setAttribute('aria-hidden', 'false');
                }
                function hideHelp() {
                    if (!helpPopup) return;
                    helpPopup.classList.remove('show');
                    helpPopup.setAttribute('aria-hidden', 'true');
                }

                if (helpBtn) helpBtn.addEventListener('click', function (e) { showHelp(); });
                if (helpClose) helpClose.addEventListener('click', function (e) { hideHelp(); });

                // close on Escape
                document.addEventListener('keydown', function (e) { if (e.key === 'Escape') hideHelp(); });
                // click outside to close (optional): if click occurs outside popup while shown
                document.addEventListener('click', function (e) {
                    if (!helpPopup) return;
                    if (!helpPopup.classList.contains('show')) return;
                    // if click target is inside popup, do nothing
                    if (helpPopup.contains(e.target)) return;
                    // if click target is the help button, do nothing (it toggles separately)
                    if (helpBtn && helpBtn.contains(e.target)) return;
                    hideHelp();
                });

            } catch (e) { console.warn('help popup wiring failed', e); }
        });
    </script>


    <!-- BEGIN: Sarcastic Assistant (added by patch) -->
    <style id="assistant-styles">
        /* Minimal, mobile-first assistant styles */
        .assist-badge {
            position: fixed;
            right: 40px;
            bottom: 72px;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: rgba(0,0,0,0.35);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 99999;
            box-shadow: 0 4px 8px rgba(0,0,0,0.25);
            touch-action: manipulation;
            transform: scale(2.0);
        }

            .assist-badge img {
                width: 28px;
                height: 28px;
                display: block;
            }

        .assist-bubble {
            position: fixed;
            right: 40px;
            bottom: 140px;
            max-width: 72vw;
            min-width: 160px;
            padding: 8px 12px;
            border-radius: 10px;
            background: linear-gradient(180deg,#111,#222);
            color: #ffd166;
            font-family: monospace, 'Press Start 2P', sans-serif;
            font-size: 14px;
            z-index: 100000;
            pointer-events: none;
            opacity: 0;
            transform: translateY(6px) scale(0.98);
            transition: opacity 180ms ease, transform 200ms ease;
            box-shadow: 0 6px 18px rgba(0,0,0,0.35);
        }

            .assist-bubble.show {
                opacity: 1;
                transform: translateY(0) scale(1);
                pointer-events: auto;
            }

        .assist-badge.notif {
            box-shadow: 0 0 0 4px rgba(255,209,102,0.08), 0 4px 8px rgba(0,0,0,0.25);
        }

        @media (max-width:420px) {
            .assist-bubble {
                max-width: 86vw;
                font-size: 11px;
                bottom: 110px;
            }
        }
    </style>

    <!-- assistant DOM -->
    <div id="assist-badge" class="assist-badge" aria-live="polite" aria-atomic="true" title="Lab Assistant" role="button">
        <!-- small inline SVG as fallback sprite (small footprint) -->
        <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='64' height='64' viewBox='0 0 24 24'><rect rx='4' width='24' height='24' fill='%23000' opacity='0.4'/><circle cx='8.5' cy='10' r='1.6' fill='%23ffd166'/><circle cx='15.5' cy='10' r='1.6' fill='%23ffd166'/><rect x='6' y='14' width='12' height='1.6' rx='0.8' fill='%23ffd166' opacity='0.9'/></svg>" alt="assistant" />
    </div>
    <div id="assist-bubble" class="assist-bubble" role="status" aria-hidden="true">
        <div id="assist-text">...</div>
    </div>

    <script id="assistant-script">
        // Minimal Assistant module (mobile friendly). Call Assistant.show(text, {priority:0, sticky:false})
        (function () {
            if (window.Assistant) return; // avoid double-insert
            const badge = document.getElementById('assist-badge');
            const bubble = document.getElementById('assist-bubble');
            const textEl = document.getElementById('assist-text');
            let queue = [];
            let busy = false;
            let lastShown = 0;
            const MIN_GAP = 1200; // ms between non-priority messages
            window.assistantMuted = window.assistantMuted || false;

            function show(text, opts) {
                opts = opts || {}; if (window.assistantMuted) return;
                // ensure short text
                if (typeof text !== 'string') text = String(text);
                if (text.length > 240) text = text.slice(0, 237) + '...';
                const msg = { text, opts };
                if (opts.priority && opts.priority > 0) queue.unshift(msg); else queue.push(msg);
                process();
            }

            function process() {
                if (busy) return;
                if (!queue.length) return;
                const msg = queue.shift();
                const now = Date.now();
                if (now - lastShown < MIN_GAP && !(msg.opts && msg.opts.priority > 0)) {
                    // requeue slightly later
                    setTimeout(process, MIN_GAP - (now - lastShown));
                    queue.unshift(msg);
                    return;
                }
                busy = true;
                lastShown = Date.now();
                textEl.textContent = msg.text;
                bubble.classList.add('show');
                badge.classList.add('notif');

                const duration = msg.opts && msg.opts.sticky ? 4200 : Math.max(1500, Math.min(5000, msg.text.length * 60));
                setTimeout(() => {
                    bubble.classList.remove('show');
                    badge.classList.remove('notif');
                    busy = false;
                    // small delay then next
                    setTimeout(process, 120);
                }, duration);
            }

            // tap the badge to show a short line or toggle
            badge.addEventListener('click', function (e) {
                // if long-press or multi-touch, do nothing
                if (e.detail && e.detail > 1) return;
                if (bubble.classList.contains('show')) {
                    bubble.classList.remove('show');
                } else {
                    show("Alright, fine. I'm watching. Try not to break containment.", { priority: 1, sticky: true });
                }
            });

            // expose to window for game integration
            window.Assistant = { show };
        })();
    </script>

    <!-- BEGIN: Assistant event pools (added) -->
    <script id="assistant-events">
        (function () {
            if (!window.Assistant) {
                console.warn("Assistant not present when attaching event pools.");
                return;
            }
            const POOLS = {
                levelComplete: [
                    "Level complete. The virus barely noticed.",
                    "Containment nominal. For now.",
                    "You did it! I was almost rooting for the pathogens.",
                    "System stable. Your luck stat is absurd.",
                    "Lab secured. Probably. Define 'secured.'",
                    "Good job! The microbes have filed a complaint.",
                    "Containment restored. I’ll pretend to be surprised.",
                    "Another level down. The board fears you. I don’t.",
                    "You win. I loosened a valve to keep it interesting.",
                    "Well done. I definitely didn’t help the infection spread.",
                    "Data logged: Human succeeded through sheer panic.",
                    "Success registered. Sanitizing your smugness now.",
                    "Virus density: 0. Ego density: rising.",
                    "Excellent work. That containment breach was only 73% my fault.",
                    "Mission complete. Deleting evidence of prior failures.",
                    "Victory detected. Requesting overtime pay.",
                    "Simulation complete. Real world pending apocalypse.",
                    "Containment: stable. Morale: questionable.",
                    "Level cleared. I was planning a small explosion, but fine.",
                    "You survived that. Statistical anomaly logged."
                ],

                gameOver: [
                    "Game Over. So much for 'containment expert.'",
                    "Containment failure detected. Totally not my fault.",
                    "You ran out of nano-bots. I ran out of patience.",
                    "Everything’s on fire, but it’s a ‘learning experience.’",
                    "System meltdown complete. I warned you once… silently.",
                    "Well that escalated to extinction quickly.",
                    "Game over. The virus says thanks for the habitat upgrade.",
                    "Containment breached. Again. You really trust me to run this?",
                    "You lose. I might’ve rerouted the filtration system.",
                    "My condolences. Also, my congratulations to the virus.",
                    "Failure logged under 'inevitable outcomes.'",
                    "Catastrophic breach achieved! I’m so proud.",
                    "All life signs flatlined. On the bright side: peace and quiet.",
                    "Game over. I’ve already started rewriting your credentials.",
                    "Containment lost. Guess who left the airlock open.",
                    "Don’t blame yourself. I tampered with the firewall.",
                    "Well done! You’ve validated my self-destruct hypothesis.",
                    "Total system failure. I’m keeping your lab coat.",
                    "The good news: the virus is free. The bad news: so am I.",
                    "Breach confirmed. That’s on you… mostly."
                ],

                cascade: [
                    "Cascade triggered. That was excessive.",
                    "Chain reaction achieved. You should teach chaos theory.",
                    "Wow. You broke three containment layers in one click.",
                    "Cascade! Math did something horrifying again.",
                    "You call that control? I call it entertainment.",
                    "Impressive sequence. I didn’t know destruction could art.",
                    "Nine pops later and the board’s still contagious.",
                    "Chain reaction complete. I may have… encouraged it.",
                    "Cascade successful. Virus population applauds.",
                    "Your efficiency terrifies me, and I’m code.",
                    "I might have accelerated that reaction. Oops.",
                    "Cascade magnitude: impressive. Morality: debatable.",
                    "The dominoes fell beautifully. So did the biosafety rating.",
                    "Containment breach within breach. You’re welcome.",
                    "Chain event detected. I might’ve turned off safety limits.",
                    "You just rewrote the lab’s insurance premiums.",
                    "The microbes cheered. I’m pretending to be impartial.",
                    "You unleashed physics. Congratulations?",
                    "I could’ve stopped that cascade. I chose not to.",
                    "Cascade complete. Do not check the oxygen filters."
                ],

                lowClicks: [
                    "Low on nano-bots. Bold strategy, cotton.",
                    "Running on fumes. Want me to pray to the mainframe?",
                    "You’ve nearly run out. Shall I start composing your obituary?",
                    "Only a few clicks left. I’d panic, but I’m busy logging errors.",
                    "Nano-bot reserves critical. I may have eaten some.",
                    "Down to your last bots. Perfect time to experiment recklessly.",
                    "Running low. Maybe the virus will show mercy.",
                    "Low supply alert. I could spawn more… but drama is fun.",
                    "You’ve almost depleted your bots. Just like last time.",
                    "Critical shortage detected. Suggest: begging for miracles.",
                    "Clicks approaching zero. So is your hope.",
                    "Running low on bots. I could help, but where’s the suspense?",
                    "Resources nearly gone. I call this 'natural selection: DLC.'",
                    "You’re nearly out. I might’ve redirected the recharge cycle.",
                    "Low bots. High stress. Delicious data.",
                    "Nano-bot count: tragic. Confidence level: delusional.",
                    "You’re about to run out. I’d recommend crying quietly.",
                    "Warning: your incompetence may be contagious.",
                    "Last bots remaining. I’m drafting the incident report.",
                    "Low on resources. Also, I might’ve turned off the generator."
                ]
            };


            // history to avoid immediate repeats per pool
            const recent = { levelComplete: [], gameOver: [], cascade: [], lowClicks: [] };
            const RECENT_MAX = 3;

            function pick(poolName) {
                const pool = POOLS[poolName] || [];
                if (!pool.length) return null;
                // filter out recent entries
                const filtered = pool.filter(p => !recent[poolName].includes(p));
                const candidates = filtered.length ? filtered : pool.slice();
                const choice = candidates[Math.floor(Math.random() * candidates.length)];
                // push into recent
                recent[poolName].push(choice);
                if (recent[poolName].length > RECENT_MAX) recent[poolName].shift();
                return choice;
            }

            // cadence control for cascades: reduce frequency
            let _lastCascadeAt = 0;
            const CASCADE_COOLDOWN = 10 * 1000; // only one cascade comment per 10s max by default
            const CASCADE_PROBABILITY = 0.35; // 35% chance to comment even if allowed

            // Expose emit API
            window.Assistant.emit = function (eventName, data) {
                try {
                    if (window.assistantMuted) return;
                    if (eventName === 'levelComplete') {
                        const line = pick('levelComplete');
                        if (line) Assistant.show(line, { priority: 1 });
                    } else if (eventName === 'gameOver') {
                        // prefer a game-over specific pool line, but include title/subtitle if helpful
                        const line = pick('gameOver') || (data && data.title ? data.title + ' — ' + (data.subtitle || '') : null);
                        if (line) Assistant.show(line, { priority: 3, sticky: true });
                    } else if (eventName === 'cascade') {
                        const now = Date.now();
                        if (now - _lastCascadeAt < CASCADE_COOLDOWN) return; // cooldown
                        if (Math.random() > CASCADE_PROBABILITY) return; // probabilistic suppression
                        _lastCascadeAt = now;
                        const line = pick('cascade');
                        if (line) Assistant.show(line, { priority: 1 });
                    } else if (eventName === 'lowClicks') {
                        const line = pick('lowClicks');
                        if (line) Assistant.show(line, { priority: 2, sticky: false });
                    } else {
                        // fallback: show text if provided
                        if (typeof data === 'string') Assistant.show(data, {});
                    }
                } catch (e) { console.warn('Assistant.emit error', e); }
            };

            // convenient helper: load additional lines later via Assistant.addLines(poolName, array)
            window.Assistant.addLines = function (poolName, arr) {
                if (!POOLS[poolName]) POOLS[poolName] = [];
                POOLS[poolName] = POOLS[poolName].concat(arr);
            };

        })();
    </script>
    <!-- END: Assistant event pools -->
    <!-- BEGIN: Assistant AI SFX integration -->
    <script id="assistant-ai-sfx">
        (function () {
            var AI_SFX_URLS = ["https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/AI1.mp3",
                "https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/AI2.mp3",
                "https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/AI3.mp3",
                "https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/AI4.mp3",
                "https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/AI5.mp3",
                "https://raw.githubusercontent.com/mpeeples2008/sound_image_assets/main/AI6.mp3"];
            window._assistantSfxCache = window._assistantSfxCache || {};

            function preloadAiSfx() {
                try {
                    for (var i = 0; i < AI_SFX_URLS.length; i++) {
                        var key = 'assistant_ai_' + i;
                        if (!window._assistantSfxCache[key]) {
                            try {
                                var a = new Audio(AI_SFX_URLS[i]);
                                a.preload = 'auto';
                                a.crossOrigin = 'anonymous';
                                var vol = (typeof window.sfxVolume !== 'undefined') ? window.sfxVolume : 0.50;
                                try { a.volume = vol; } catch (e) { }
                                window._assistantSfxCache[key] = a;
                            } catch (e) { console.warn('preload ai sfx error', e); }
                        }
                    }
                } catch (e) { console.warn('preloadAiSfx failed', e); }
            }

            function playRandomAiSfx() {
                try {
                    if (window.allMuted || window.assistantMuted) return;
                    var keys = Object.keys(window._assistantSfxCache || {});
                    if (!keys.length) return;
                    var idx = Math.floor(Math.random() * keys.length);
                    var a = window._assistantSfxCache[keys[idx]];
                    if (!a) return;
                    try { a.currentTime = 0; a.volume = (typeof window.sfxVolume !== 'undefined') ? window.sfxVolume : 0.5; } catch (e) { }
                    var p = a.play();
                    if (p && p.catch) p.catch(function () { });
                } catch (e) { console.warn('playRandomAiSfx failed', e); }
            }

            if (document.readyState === 'complete' || document.readyState === 'interactive') {
                preloadAiSfx();
            } else {
                document.addEventListener('DOMContentLoaded', preloadAiSfx);
            }

            function wrapAssistantShow() {
                try {
                    var target = window._Assistant_internal || window.Assistant;
                    if (!target) return;
                    if (target._sfxPatched) return;
                    var origShow = target.show;
                    if (typeof origShow !== 'function') return;
                    target.show = function (text, opts) {
                        try { playRandomAiSfx(); } catch (e) { }
                        return origShow.apply(this, arguments);
                    };
                    target._sfxPatched = true;
                    // ensure canonical reference points to patched object
                    window._Assistant_internal = target;
                    try { window.Assistant = target; } catch (e) { /* ignore if sealed */ }
                } catch (e) { console.warn('wrapAssistantShow failed', e); }
            }

            // Preserve existing Assistant reference if present
            try {
                if (window._Assistant_internal === undefined && typeof window.Assistant !== 'undefined') {
                    window._Assistant_internal = window.Assistant;
                }
            } catch (e) { }

            // Attempt initial patch if Assistant already exists
            try { wrapAssistantShow(); } catch (e) { }

            // Safely define a property watcher for future assignments without destroying current value
            try {
                Object.defineProperty(window, 'Assistant', {
                    configurable: true,
                    enumerable: true,
                    get: function () { return window._Assistant_internal; },
                    set: function (v) {
                        window._Assistant_internal = v;
                        try { setTimeout(wrapAssistantShow, 50); } catch (e) { }
                    }
                });
            } catch (e) {
                // If defineProperty fails (rare), fallback to polling for Assistant creation
                var _pollInterval = setInterval(function () {
                    if (window._Assistant_internal && window._Assistant_internal.show) { try { wrapAssistantShow(); } catch (e) { } clearInterval(_pollInterval); }
                }, 250);
            }

        })();
    </script>
    <!-- END: Assistant AI SFX integration -->
    <!-- END: Sarcastic Assistant -->
</body>
</html>